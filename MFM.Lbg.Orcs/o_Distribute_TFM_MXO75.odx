#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="d919e30b-578f-400d-8a25-d168a826b41c" LowerBound="1.1" HigherBound="722.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="MFM.Lbg.Orcs" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="ccdce60d-199b-429b-b8ca-dea89a5b9c8e" ParentLink="Module_PortType" LowerBound="12.1" HigherBound="19.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:portType name=&quot;MTFMVISIONFM_MTFMVISIONLOCQUERYPortType&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="MTFMVISIONFM_MTFMVISIONLOCQUERYPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4601c3d0-7ca9-4903-b161-375432ecdd84" ParentLink="PortType_OperationDeclaration" LowerBound="14.1" HigherBound="18.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:operation name=&quot;QueryMXVISIONLOCQUERY&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="QueryMXVISIONLOCQUERY" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="501da577-520b-4355-a1eb-e16e2a3e2256" ParentLink="OperationDeclaration_FaultMessageRef" LowerBound="16.74" HigherBound="16.122">
                    <om:Property Name="Ref" Value="BTS.soap_envelope_1__1.Fault" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="SoapBuildingFault" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="589db7b3-7c99-4035-bb70-a3f69ad7df12" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="16.43" HigherBound="16.72">
                    <om:Property Name="Ref" Value="MFM.Lbg.Orcs.QueryMXVISIONLOCQUERYResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="&lt;wsdl:output message=&quot;http://www.ibm.com/maximo/wsdl/MTFMVISIONFM_MTFMVISIONLOCQUERY:QueryMXVISIONLOCQUERYResponse&quot;/&gt;&#xD;&#xA;" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="f0621440-e675-4df7-8305-d0d4706ee64b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="16.13" HigherBound="16.41">
                    <om:Property Name="Ref" Value="MFM.Lbg.Orcs.QueryMXVISIONLOCQUERYRequest" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="&lt;wsdl:input message=&quot;http://www.ibm.com/maximo/wsdl/MTFMVISIONFM_MTFMVISIONLOCQUERY:QueryMXVISIONLOCQUERYRequest&quot;/&gt;&#xD;&#xA;" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="222b13ff-98b1-4166-8da3-34161410ab72" ParentLink="Module_PortType" LowerBound="19.1" HigherBound="26.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Port_get_TFM_MXO75_WO_Type" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="752f06be-aa6d-4eea-ae07-2245df3a3b41" ParentLink="PortType_OperationDeclaration" LowerBound="21.1" HigherBound="25.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="496a7cd3-9717-4c66-a566-65ec97aa19c8" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="23.13" HigherBound="23.48">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="fa3f0d24-f63d-4b2f-95fd-ee8f666a29b6" ParentLink="Module_PortType" LowerBound="26.1" HigherBound="33.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Port_Send_TFM_MXO75_WO_type" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="cf930691-aae5-40c1-a9c0-ec0c9f6de8d3" ParentLink="PortType_OperationDeclaration" LowerBound="28.1" HigherBound="32.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="8834e09c-feff-4254-8e9c-870e50039784" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="30.13" HigherBound="30.48">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="a742842c-d901-423c-a9d6-4fabb5091e8b" ParentLink="Module_PortType" LowerBound="33.1" HigherBound="40.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="TestPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="f1f4aa1f-2ec0-48fe-8ee9-525e03665f35" ParentLink="PortType_OperationDeclaration" LowerBound="35.1" HigherBound="39.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0c037fda-245e-4138-b148-fd2ce2389983" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="37.13" HigherBound="37.42">
                    <om:Property Name="Ref" Value="MFM.Lbg.Orcs.QueryMXVISIONLOCQUERYResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="505afa6b-e425-4834-a4c1-39b72f851682" ParentLink="Module_PortType" LowerBound="40.1" HigherBound="47.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Standard_Biz_Comm_Type" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="734bd0ea-d30f-4252-8fb0-bc3e1750518f" ParentLink="PortType_OperationDeclaration" LowerBound="42.1" HigherBound="46.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="2b203887-3ac0-4204-9539-a2288e1c8fa6" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="44.13" HigherBound="44.41">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.BizTalk_Comm" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="ffcb4d33-be12-4847-9475-ac7373617709" ParentLink="Module_PortType" LowerBound="47.1" HigherBound="54.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="TFM_Backup_Port_Type" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4a68c52a-bd30-4d5a-8080-6cfb7e970270" ParentLink="PortType_OperationDeclaration" LowerBound="49.1" HigherBound="53.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="a98792b2-f2f3-4926-89c5-a9dda059dfcd" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="51.13" HigherBound="51.48">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="29037ad1-2aac-4507-9a03-b24fbb07f2e8" ParentLink="Module_PortType" LowerBound="54.1" HigherBound="61.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Archive_Sent_TFM_Wo_Type" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="9d4d103c-f830-4227-9344-43335ed90637" ParentLink="PortType_OperationDeclaration" LowerBound="56.1" HigherBound="60.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="6529c66d-45a8-45b0-875d-7380fd8adbfe" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="58.13" HigherBound="58.48">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="a8549d08-3daf-4b62-936e-091bc9679c62" ParentLink="Module_PortType" LowerBound="61.1" HigherBound="68.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Question_Port_Type" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="07acb9ad-3ddb-4684-96e0-c74f27d19f3a" ParentLink="PortType_OperationDeclaration" LowerBound="63.1" HigherBound="67.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="biz_Get_Questions" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="fbd97c84-e705-43fb-8bc6-711e496409c1" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="65.13" HigherBound="65.83">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_Questions" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="a8568edf-c0d4-44e8-8cc4-005be9722cf7" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="65.85" HigherBound="65.163">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_QuestionsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="c645a93c-b162-4bf8-81a1-f3985e390b71" ParentLink="Module_PortType" LowerBound="68.1" HigherBound="75.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PublishNotifyEmailToMbType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="cfdcea8b-96b1-4f7f-a8c5-2c7043a55e4d" ParentLink="PortType_OperationDeclaration" LowerBound="70.1" HigherBound="74.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="105ceecf-52c6-4c2f-8454-611a4e7add10" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="72.13" HigherBound="72.52">
                    <om:Property Name="Ref" Value="MSS.Notification.Service.MSSNotifyEmail" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="33582e59-4d5c-40d4-b6ab-8302a0b8ecb0" ParentLink="Module_PortType" LowerBound="75.1" HigherBound="82.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Failed_Send_Port_Type" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="75717ed5-7db1-4e7e-bc1d-d3977649229b" ParentLink="PortType_OperationDeclaration" LowerBound="77.1" HigherBound="81.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="bd44c6da-5f5a-452c-aa82-1dda4a0cbae5" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="79.13" HigherBound="79.48">
                    <om:Property Name="Ref" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="3b161978-1268-432a-844f-c1c7270adf0f" ParentLink="Module_ServiceDeclaration" LowerBound="82.1" HigherBound="721.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="Query for SITEID - required to successfully load workorder.  Terminate on any failure.  Ensure record is requeued. capture system.web.services.protocol.soapexception, system.web.net.webexception, " />
            <om:Property Name="Name" Value="o_Distribute_TFM_MXO75" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="bb853b43-7259-4b48-a2b4-9f981af63f3a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="130.1" HigherBound="131.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="LocationStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="89b04554-59cd-47f7-aa11-6f91f9ed9d8d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="131.1" HigherBound="132.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="tplSupport" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8c77f9b8-8386-42ee-968d-8fefac6bdc98" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="132.1" HigherBound="133.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mtfm2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ae7b4f9a-f92d-46a2-b560-c6d44f9ac463" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="133.1" HigherBound="134.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="biz_comm_obj_xml" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ce994da9-9db4-47ad-847c-96a0db57b9c3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="134.1" HigherBound="135.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="WasWebQError" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="26bf6c81-fc55-4a64-b087-951d9ab76d1b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="135.1" HigherBound="136.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="WasBackup" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9cd48d2c-1653-4425-b262-3efa7bd90c9f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="136.1" HigherBound="137.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Target" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2eb8ae49-dbb7-481e-8cf2-f7a7a7bd7bcf" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="137.1" HigherBound="138.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Filename" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0e469168-5a94-42b5-a2ca-7bf638f4e0ae" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="138.1" HigherBound="139.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="biz_comm_str" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d8949944-a2da-422d-91c8-bd9bc6fdc482" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="139.1" HigherBound="140.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="biz_comm_obj" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fb7e648e-63fd-43ef-8b01-c51ef9b7d18f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="140.1" HigherBound="141.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="helpdeskref" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5684a18d-a53f-4dee-b088-18a2c44ad666" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="141.1" HigherBound="142.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="skip" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e72970cc-74fb-4430-b6b6-4e1202af93eb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="142.1" HigherBound="143.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="errMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="33691063-ea0c-4140-a754-4c4cb6b7c2b5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="143.1" HigherBound="144.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="eventLogSource" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c97e4694-345f-4421-9a91-fc29e6c7d12b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="144.1" HigherBound="145.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="dummy1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="af34123c-393b-4591-96d9-ae4f0928b0d4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="145.1" HigherBound="146.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Contract" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9ae32d8b-2b7b-442f-80c0-a3f5ee515704" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="146.1" HigherBound="147.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mtfm1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7d135bd2-6003-4b5e-b22d-bcaedce9f21d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="147.1" HigherBound="148.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlNack" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="af663fa2-b4f8-4a1d-a969-16cdda050146" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="148.1" HigherBound="149.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ErrorDescription" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="95596898-b257-49ab-8282-e48c68fdb460" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="149.1" HigherBound="150.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="WebServiceAvailable" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5a767cf9-f947-47a4-98de-9517d3ffebe2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="150.1" HigherBound="151.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="RetryCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="46641d40-56c1-4ea2-adf4-3cf11f05c265" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="151.1" HigherBound="152.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="stdXmlCommText" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="24789f71-3034-41c2-892d-ee9ca879a2ca" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="152.1" HigherBound="153.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="MFM.Lbg.Helper.Misc" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Helper2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="09920514-a416-45b5-ae32-9c96419f0f6c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="153.1" HigherBound="154.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CommodityValid" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0fdcd3d0-18c7-4cfa-8372-d200d3dd3b0d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="154.1" HigherBound="155.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CommodityCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7e3ddea2-8e35-41b8-8fad-bf6ae1be5045" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="155.1" HigherBound="156.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="DatesExist" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e8b6a84b-f730-40c6-9784-5b65761d75e0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="156.1" HigherBound="157.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="useTranslation" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="69e9ab5f-a04c-46ff-9801-0a1bec8cba4d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="157.1" HigherBound="158.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SwitchXslt" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="10f7629b-1897-4501-a56c-69aa3a606f66" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="158.1" HigherBound="159.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="tpl247" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ec90109c-decb-41fa-bd58-ba127c012ab6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="159.1" HigherBound="160.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="tplDist" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="54f135d9-6501-4de8-b1d1-e7caecb42d5a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="160.1" HigherBound="161.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="tplNotify" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b2035de1-e7d3-47c8-b8f1-172c9a12dfe9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="161.1" HigherBound="162.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Transmitted" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="517b9365-4a15-4b09-94cc-28683f012abe" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="107.1" HigherBound="108.1">
                <om:Property Name="Type" Value="MSS.Notification.Service.MSSNotifyEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="NotifyEmailOut" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1ee04a8f-97a6-4312-8608-5ce7b4d3f841" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="108.1" HigherBound="109.1">
                <om:Property Name="Type" Value="BTS.soap_envelope_1__1.Fault" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Soap_Fault_BuildingCheck" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="f2d1b089-7bca-46bd-83c6-1cc52ea0a9d6" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="109.1" HigherBound="110.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="TFM_MXO75_F_22" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="492d78f2-2605-4851-bf7b-8685f22555d1" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="110.1" HigherBound="111.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_QueueResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="UnblockResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4bc1ec73-a16c-4579-b332-68d891cb04fe" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="111.1" HigherBound="112.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_Queue" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Unblock" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="73a33e6f-5b16-4d76-8963-d33164740dbd" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="112.1" HigherBound="113.1">
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.QueryMXVISIONLOCQUERYResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetSiteIdQueryResponse_out" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1e4b3839-b98c-4470-9276-72d466bbdcd8" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="113.1" HigherBound="114.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.BizTalk_Comm" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Biz_comm_ex_Delivery" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d8476343-2b5f-4e9f-bbda-7f5aca561f42" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="114.1" HigherBound="115.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="TFM_MXO75_F_2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="6f8d887a-90f1-4513-a796-81f1c9846b3c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="115.1" HigherBound="116.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="TFM_MXO75_WO_F" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="7340d94b-3c7e-45c2-9460-25b38ff61474" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="116.1" HigherBound="117.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_QueueResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="DistributedResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a01eeefc-5be8-4efc-a7af-63ad39dcb59c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="117.1" HigherBound="118.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_Queue" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Distributed" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4d503c2f-1d94-4474-979a-3d5e8ba0ed0f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="118.1" HigherBound="119.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="TFM_MXO75_WO" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="69c2d15a-f0f1-4b50-852a-fb74f1f9f510" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="119.1" HigherBound="120.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="DistributedWorkItem" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="b6950ffa-608c-4034-a945-6e2085f5e40a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="120.1" HigherBound="121.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.MTFMWOINService.MTFMWOIN" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="TFM_MXO75_WO_R" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="66d7bab6-6e30-42ae-8eba-0afe76d9906e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="121.1" HigherBound="122.1">
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.QueryMXVISIONLOCQUERYRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetSiteIdQuery" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="84b50a1b-89cf-4727-8680-e9b1f788c555" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="122.1" HigherBound="123.1">
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.QueryMXVISIONLOCQUERYResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetSiteIdQueryResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="20ca8b24-a7af-4e61-9b62-65bbfa1b4a73" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="123.1" HigherBound="124.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.BizTalk_Comm" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="biz_comm" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="def1f367-1eae-441d-a0c5-5c557f2a5148" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="124.1" HigherBound="125.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_Questions" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetQuestion" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="934d402b-214e-461b-867b-9a06d6c84551" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="125.1" HigherBound="126.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_QuestionsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetQuestionResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1baa70cc-390a-4b5c-97d8-ebc28837b511" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="126.1" HigherBound="127.1">
                <om:Property Name="Type" Value="MFM.SharedResources.MSurvey" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SharedSurvey" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4ea49895-0f0a-4ed8-9a98-d9e6407b3a46" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="127.1" HigherBound="128.1">
                <om:Property Name="Type" Value="MFM.Lbg.Schemas.MiamiSoapError" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MiamiSoapBuildingFriendly" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="22c28846-6be8-4b77-bae8-9abac43a7038" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="128.1" HigherBound="129.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgNack" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="36179b6a-d6b4-4d6e-83d1-5920d5368283" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="129.1" HigherBound="130.1">
                <om:Property Name="Type" Value="MSS.Notification.Service.MSSNotifyEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="NotifyEmailParent" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="95919b94-c126-4d8c-8c01-d3909e485a7d" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="128613b0-c76c-4eb4-a270-22deb4ccb000" ParentLink="ServiceBody_Statement" LowerBound="164.1" HigherBound="196.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_Get_TFM_MXO75_WO" />
                    <om:Property Name="MessageName" Value="DistributedWorkItem" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_TFMMXO75_WorkItem" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DNFPredicate" OID="eb5dd965-de4c-4f61-9f30-b058737fccdf" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="MFM.Lbg.Schemas.VendorSystem" />
                        <om:Property Name="RHS" Value="&quot;TFMMXO75&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="59388df1-ed6a-41be-aa56-df2762ccad42" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="MFM.Lbg.Schemas.Property1" />
                        <om:Property Name="RHS" Value="&quot;VFX&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="NotEquals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="297d8545-ad64-4fe7-80cd-5c3669baf82f" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="MFM.Lbg.Schemas.ServiceLine1" />
                        <om:Property Name="RHS" Value="&quot;VFX&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="NotEquals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="68cb9920-5791-40d4-ac8f-0c3660656938" ParentLink="ServiceBody_Statement" LowerBound="196.1" HigherBound="213.1">
                    <om:Property Name="Expression" Value="Filename = System.Convert.ToString(DistributedWorkItem(FILE.ReceivedFileName));&#xD;&#xA;Target = System.String.Format(&quot;CAFM={0}&quot;,DistributedWorkItem(MFM.Lbg.Schemas.VendorSystem));&#xD;&#xA;Filename = Filename.Replace(&quot;Type=Extract&quot;,Target);&#xD;&#xA;skip = false;&#xD;&#xA;helpdeskref = DistributedWorkItem.IssuedWork.Workitem.HelpdeskReference;&#xD;&#xA;eventLogSource = &quot;MFMHelpdeskDistributor&quot;;&#xD;&#xA;WasBackup = false;&#xD;&#xA;WebServiceAvailable = false;&#xD;&#xA;CommodityValid = false;&#xD;&#xA;CommodityCode = DistributedWorkItem.IssuedWork.Workitem.MService.VendorCode;&#xD;&#xA;tpl247 = &quot;TEAM247&quot;;&#xD;&#xA;tplDist = &quot;DIST&quot;;&#xD;&#xA;tplNotify = &quot;TFM&quot;;&#xD;&#xA;tplSupport = &quot;TEAMSUPP&quot;;&#xD;&#xA;useTranslation = true;&#xD;&#xA;Transmitted = false;&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Init Vars" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="fc49c244-0b73-49a1-b679-15a13025dd63" ParentLink="ServiceBody_Statement" LowerBound="213.1" HigherBound="218.1">
                    <om:Property Name="Expression" Value="Contract = DistributedWorkItem.IssuedWork.MRoute.ContractName;&#xD;&#xA;mtfm1 = DistributedWorkItem.IssuedWork.Workitem.Location.linkpropertyid;&#xD;&#xA;mtfm2 = DistributedWorkItem.IssuedWork.Workitem.Location.Address.siteSiteID;&#xD;&#xA;RetryCount = 0;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Set Error Handling" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="Task" OID="0ca79366-831a-4c2a-b663-c6ec9846f10e" ParentLink="ServiceBody_Statement" LowerBound="218.1" HigherBound="249.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Group_Core_messages" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Construct" OID="c7a851a1-e4f1-44a0-9326-32357bcad25e" ParentLink="ComplexStatement_Statement" LowerBound="218.1" HigherBound="224.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="AnalystComments" Value="Clone this message for each error" />
                        <om:Property Name="Name" Value="CreateParentEmailAlert" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="728ec50f-5128-400e-ab10-dc084c23b46c" ParentLink="Construct_MessageRef" LowerBound="219.23" HigherBound="219.40">
                            <om:Property Name="Ref" Value="NotifyEmailParent" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="1261d58c-235f-4c0e-bbda-9700f9147667" ParentLink="ComplexStatement_Statement" LowerBound="221.1" HigherBound="223.1">
                            <om:Property Name="ClassName" Value="MFM.Lbg.Orcs.Base_Email_Notification" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Base_Email_Notification" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="MessagePartRef" OID="149a910f-24ff-4d08-ae73-c6d2bc265c6a" ParentLink="Transform_InputMessagePartRef" LowerBound="222.87" HigherBound="222.106">
                                <om:Property Name="MessageRef" Value="DistributedWorkItem" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_12" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="2ca5b308-f7ba-4160-ab8b-081f56ffd40f" ParentLink="Transform_OutputMessagePartRef" LowerBound="222.28" HigherBound="222.45">
                                <om:Property Name="MessageRef" Value="NotifyEmailParent" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_13" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="d462a77a-12e0-40cc-8095-7fee2ebeff07" ParentLink="ComplexStatement_Statement" LowerBound="224.1" HigherBound="231.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Construct TFM MXO75 WO" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="7fcca725-f4f1-403a-b3c1-942c53820e2e" ParentLink="Construct_MessageRef" LowerBound="225.23" HigherBound="225.35">
                            <om:Property Name="Ref" Value="TFM_MXO75_WO" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="169e91be-b985-4e90-beb8-1f80fdd9cf0b" ParentLink="ComplexStatement_Statement" LowerBound="227.1" HigherBound="230.1">
                            <om:Property Name="Expression" Value="TFM_MXO75_WO = DistributedWorkItem;&#xD;&#xA;TFM_MXO75_WO(FILE.ReceivedFileName) = Filename;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Assign_MFM_MXO75_WO" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="8f87dd56-a2b0-4f84-8bf2-2987e73a1d98" ParentLink="ComplexStatement_Statement" LowerBound="231.1" HigherBound="237.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Construct_Distributed" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="b6fefd53-f833-4194-9acc-b29930d89b4d" ParentLink="Construct_MessageRef" LowerBound="232.23" HigherBound="232.34">
                            <om:Property Name="Ref" Value="Distributed" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="eaf7f73b-b4dd-4d4b-bae5-9e63812dacf6" ParentLink="ComplexStatement_Statement" LowerBound="234.1" HigherBound="236.1">
                            <om:Property Name="ClassName" Value="MFM.Lbg.Maps.DistributeMessage_To_RemoveFromQueue" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="x_To_Distributed" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="5bcb678a-2590-4864-b6ad-8a3551e92fee" ParentLink="Transform_OutputMessagePartRef" LowerBound="235.28" HigherBound="235.39">
                                <om:Property Name="MessageRef" Value="Distributed" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="b83055fc-afe7-4aad-9c5a-290fbe4512ff" ParentLink="Transform_InputMessagePartRef" LowerBound="235.94" HigherBound="235.113">
                                <om:Property Name="MessageRef" Value="DistributedWorkItem" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="dd929784-a6ea-4745-b477-998ec38eda12" ParentLink="ComplexStatement_Statement" LowerBound="237.1" HigherBound="243.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Construct_unblock" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="8805c530-f0d6-4c6a-b312-77ea249f4b15" ParentLink="Construct_MessageRef" LowerBound="238.23" HigherBound="238.30">
                            <om:Property Name="Ref" Value="Unblock" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="c6d712a8-53de-44e2-b987-754f31e5b3e6" ParentLink="ComplexStatement_Statement" LowerBound="240.1" HigherBound="242.1">
                            <om:Property Name="ClassName" Value="MFM.Lbg.Maps.DistributeMessage_To_ReQueue" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="x_to_unblock" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="63a46fc7-e316-4ae5-b70a-bb9216b4c1a3" ParentLink="Transform_InputMessagePartRef" LowerBound="241.82" HigherBound="241.101">
                                <om:Property Name="MessageRef" Value="DistributedWorkItem" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_8" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="c49f9190-a9b0-407f-bdac-2888154d6c5b" ParentLink="Transform_OutputMessagePartRef" LowerBound="241.28" HigherBound="241.35">
                                <om:Property Name="MessageRef" Value="Unblock" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_9" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="ac8dda8f-6a21-4523-9952-97326bafbdc4" ParentLink="ComplexStatement_Statement" LowerBound="243.1" HigherBound="249.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructQuery" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="bfb30d71-7c5c-4e9f-9d0f-7a81fa267b47" ParentLink="Construct_MessageRef" LowerBound="244.23" HigherBound="244.37">
                            <om:Property Name="Ref" Value="GetSiteIdQuery" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="4d166d27-9896-4466-9db1-86fd00a05923" ParentLink="ComplexStatement_Statement" LowerBound="246.1" HigherBound="248.1">
                            <om:Property Name="ClassName" Value="MFM.Lbg.Orcs.x_to_Query" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="x_to_Query" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="MessagePartRef" OID="c42c6d00-1ce5-4b07-98ea-ce9cac51e6cf" ParentLink="Transform_InputMessagePartRef" LowerBound="247.82" HigherBound="247.101">
                                <om:Property Name="MessageRef" Value="DistributedWorkItem" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_3" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="00ae195b-87be-457e-b4b4-6c1ae73a9dd9" ParentLink="Transform_OutputMessagePartRef" LowerBound="247.28" HigherBound="247.53">
                                <om:Property Name="MessageRef" Value="GetSiteIdQuery" />
                                <om:Property Name="PartRef" Value="parameters" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_4" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
                <om:Element Type="Task" OID="3d793097-a4c0-4da0-a422-76090473141e" ParentLink="ServiceBody_Statement" LowerBound="249.1" HigherBound="304.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="SLA Available" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Scope" OID="00ea891e-02c9-4250-bdb1-0de6d2911a75" ParentLink="ComplexStatement_Statement" LowerBound="249.1" HigherBound="304.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch_Missing_Sla_Dates" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="340a5410-1e24-4d16-96f8-4fe228e1748b" ParentLink="ComplexStatement_Statement" LowerBound="254.1" HigherBound="256.1">
                            <om:Property Name="Expression" Value="DatesExist = System.DateTime.Compare(DistributedWorkItem.IssuedWork.Workitem.VendorCompleteBy,DistributedWorkItem.IssuedWork.Workitem.VendorAttendBy);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="TestDates" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Catch" OID="d9e96d41-0c60-4514-b1be-88440e5f1f58" ParentLink="Scope_Catch" LowerBound="259.1" HigherBound="302.1">
                            <om:Property Name="ExceptionName" Value="eNullRef" />
                            <om:Property Name="ExceptionType" Value="System.NullReferenceException" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Catch_Null_ref" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="d931ab11-2f49-4c76-9cac-eb71cf6af006" ParentLink="Catch_Statement" LowerBound="262.1" HigherBound="266.1">
                                <om:Property Name="Expression" Value="errMsg = &quot;The target start or complete time is missing.  This must be resolved before the case can be send to the provider system.&quot;;&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;The case will be resent automatically in 10 minutes, the 'SLA Complete By' must be greater than the 'SLA Attend By' or this error will recur.  Both must exist.&quot;;&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;The case must remain at 'ALLOCATED' to be resent automatically&quot;;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Build Err" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="ddd681e4-5500-4e48-8770-19f5207a8159" ParentLink="Catch_Statement" LowerBound="266.1" HigherBound="268.1">
                                <om:Property Name="Expression" Value="stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,System.String.Format(&quot;Customer: {0}, SLA Start or Complete is missing&quot;,Contract),&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,errMsg,&quot;VisionFM&quot;);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CommMissingDates" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Parallel" OID="71ad8746-6a34-442a-afee-1ca6c968658d" ParentLink="Catch_Statement" LowerBound="268.1" HigherBound="293.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Parallel_Alerts_Missing_SLA_Dates" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="ParallelBranch" OID="5542bce2-323e-41e7-ad02-7a3d7a859bab" ParentLink="ReallyComplexStatement_Branch" LowerBound="273.1" HigherBound="286.1">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParallelBranch_2" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="5cf8ef89-d88e-46c4-a1b1-f5e579684491" ParentLink="ComplexStatement_Statement" LowerBound="273.1" HigherBound="284.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructErrorEmail_F1_247" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="1d360215-d44e-41a0-ae34-3069f39b9e90" ParentLink="ComplexStatement_Statement" LowerBound="276.1" HigherBound="283.1">
                                            <om:Property Name="Expression" Value="NotifyEmailOut = NotifyEmailParent;&#xD;&#xA;NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format(&quot;Beacon - Case: {1} Customer: {0}, SLA Start or Complete is missing&quot;,Contract,helpdeskref));&#xD;&#xA;NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']&quot;) = Helper2.XslPath(&quot;TEAM247&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']&quot;) = &quot;SLA Start or Complete is missing&quot;;&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']&quot;) = errMsg;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="Assign_F1_247" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="4985c8d4-aabc-4d7a-b3f0-1fc6ab80e5d2" ParentLink="Construct_MessageRef" LowerBound="274.43" HigherBound="274.57">
                                            <om:Property Name="Ref" Value="NotifyEmailOut" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="a60828ea-f744-464e-8f31-b7b5dc94beb6" ParentLink="ComplexStatement_Statement" LowerBound="284.1" HigherBound="286.1">
                                        <om:Property Name="PortName" Value="PublishNotifyEmailToMb" />
                                        <om:Property Name="MessageName" Value="NotifyEmailOut" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_F1_Error_247" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="ParallelBranch" OID="5cde5470-c40b-413d-81bb-3384a8d4c448" ParentLink="ReallyComplexStatement_Branch" LowerBound="289.1" HigherBound="291.1">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParallelBranch_9" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Exec" OID="65a05322-7c89-4aee-9a80-3753c5defc57" ParentLink="ComplexStatement_Statement" LowerBound="289.1" HigherBound="291.1">
                                        <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="AnalystComments" Value="Create the VisionFM comm and OPs Support alert" />
                                        <om:Property Name="Name" Value="F1 Comm" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Parameter" OID="0ad73135-071c-460d-821f-c5e212844382" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="stdXmlCommText" />
                                            <om:Property Name="Type" Value="System.String" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Delay" OID="f9e4138e-1825-44cb-ae0a-0ce633325a91" ParentLink="Catch_Statement" LowerBound="293.1" HigherBound="295.1">
                                <om:Property Name="Timeout" Value="new System.TimeSpan(0,0,10,0);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Delay_Reprocess" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Send" OID="0e5b9b00-a26e-4ccc-9367-3ca3deb0025e" ParentLink="Catch_Statement" LowerBound="295.1" HigherBound="297.1">
                                <om:Property Name="PortName" Value="Reprocess_Dates" />
                                <om:Property Name="MessageName" Value="Unblock" />
                                <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_4" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Receive" OID="2c6334c6-bcde-420a-91d6-b585937bc365" ParentLink="Catch_Statement" LowerBound="297.1" HigherBound="299.1">
                                <om:Property Name="Activate" Value="False" />
                                <om:Property Name="PortName" Value="Reprocess_Dates" />
                                <om:Property Name="MessageName" Value="UnblockResponse" />
                                <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="OperationMessageName" Value="Response" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Receive_4" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="15a04beb-eb99-4b6a-8598-1efce9d3fb80" ParentLink="Catch_Statement" LowerBound="299.1" HigherBound="301.1">
                                <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;Date Breach: Terminate export for {0}.  Case will be reprocessed if still Allocated.&quot;,helpdeskref);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_Missing Dates" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
                <om:Element Type="Decision" OID="55aa3365-97a2-4493-bedd-242b6c77cc86" ParentLink="ServiceBody_Statement" LowerBound="304.1" HigherBound="349.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Valid Target Dates" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DecisionBranch" OID="7bb391ee-bc41-461c-a0ae-023f909f2611" ParentLink="ReallyComplexStatement_Branch" LowerBound="305.13" HigherBound="349.1">
                        <om:Property Name="Expression" Value="System.DateTime.Compare(DistributedWorkItem.IssuedWork.Workitem.VendorCompleteBy,DistributedWorkItem.IssuedWork.Workitem.VendorAttendBy) &lt; 0" />
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="SLA Complete &lt; Attend" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="Task" OID="6d9e9db0-7161-4cf6-b0ae-5f92abaed158" ParentLink="ComplexStatement_Statement" LowerBound="307.1" HigherBound="346.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Handle Bad SLA Dates" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="5353b618-249b-43e1-9ccd-510df9268d6a" ParentLink="ComplexStatement_Statement" LowerBound="307.1" HigherBound="313.1">
                                <om:Property Name="Expression" Value="errMsg = &quot;The target complete time is before the target attend time. This must be resolved before the case can be send to the provider system.&quot;;&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;Attend: &quot; + System.Convert.ToString(DistributedWorkItem.IssuedWork.Workitem.VendorAttendBy);&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;Complete: &quot; + System.Convert.ToString(DistributedWorkItem.IssuedWork.Workitem.VendorCompleteBy);&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;The case will be resent automatically in 10 minutes, the 'SLA Complete By' must be greater than the 'SLA Attend By' or this error will recur.&quot;;&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;The case must remain at 'ALLOCATED' to be resent automatically&quot;;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Build Err" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="b5f0c227-faab-4fc2-ad6a-0a61b4891d98" ParentLink="ComplexStatement_Statement" LowerBound="313.1" HigherBound="315.1">
                                <om:Property Name="Expression" Value="stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,System.String.Format(&quot;Customer: {0}, Error: SLA Complete is before SLA Attend.&quot;,Contract),&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,errMsg,&quot;VisionFM&quot;);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CommBadDates" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Parallel" OID="ee3b44f4-6f39-46c9-9c60-cc03a5eaabde" ParentLink="ComplexStatement_Statement" LowerBound="315.1" HigherBound="340.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Parallel_Alerts_Bad_AttendComplete" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="ParallelBranch" OID="4ab5cecc-7b8f-4814-91c1-de556d6ac34b" ParentLink="ReallyComplexStatement_Branch" LowerBound="320.1" HigherBound="333.1">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParallelBranch_2" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="d0003cd0-55e4-418f-99cf-e202fa78a7fa" ParentLink="ComplexStatement_Statement" LowerBound="320.1" HigherBound="331.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructErrorEmail_F2_247" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="d04e2092-9d29-4a2b-88e2-ec4800e49a55" ParentLink="Construct_MessageRef" LowerBound="321.35" HigherBound="321.49">
                                            <om:Property Name="Ref" Value="NotifyEmailOut" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="c2be4f77-9e89-4295-a5ae-c589e320a779" ParentLink="ComplexStatement_Statement" LowerBound="323.1" HigherBound="330.1">
                                            <om:Property Name="Expression" Value="NotifyEmailOut = NotifyEmailParent;&#xD;&#xA;NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format(&quot;Beacon - Case: {1} Customer: {0}, SLA Complete is before SLA Attend&quot;,Contract,helpdeskref));&#xD;&#xA;NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']&quot;) = Helper2.XslPath(&quot;TEAM247&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']&quot;) = &quot;Error - SLA Complete is before SLA Attend&quot;;&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']&quot;) = errMsg;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="Assign_F2_247" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="ab16828a-40ab-4252-a559-b3ee266c7bd7" ParentLink="ComplexStatement_Statement" LowerBound="331.1" HigherBound="333.1">
                                        <om:Property Name="PortName" Value="PublishNotifyEmailToMb" />
                                        <om:Property Name="MessageName" Value="NotifyEmailOut" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_F2_Error_247" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="ParallelBranch" OID="b47e8e19-ebf6-4c5c-b098-ff5a7ee732e7" ParentLink="ReallyComplexStatement_Branch" LowerBound="336.1" HigherBound="338.1">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ParallelBranch_8" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Exec" OID="26b573c7-268e-49c1-90ea-2eaed3d83bbb" ParentLink="ComplexStatement_Statement" LowerBound="336.1" HigherBound="338.1">
                                        <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="AnalystComments" Value="Create the VisionFM comm and OPs Support alert" />
                                        <om:Property Name="Name" Value="F2 Comm" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Parameter" OID="972f5dec-3e3b-49e2-bdcf-c294661ecc23" ParentLink="InvokeStatement_Parameter">
                                            <om:Property Name="Direction" Value="In" />
                                            <om:Property Name="Name" Value="stdXmlCommText" />
                                            <om:Property Name="Type" Value="System.String" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Delay" OID="d0c24c9f-a59e-4e55-9488-f6b7dc7cf134" ParentLink="ComplexStatement_Statement" LowerBound="340.1" HigherBound="342.1">
                                <om:Property Name="Timeout" Value="new System.TimeSpan(0,0,10,0);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Delay_Reprocess" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Send" OID="7da0873b-5d37-4475-90ac-bc990f23cd78" ParentLink="ComplexStatement_Statement" LowerBound="342.1" HigherBound="344.1">
                                <om:Property Name="PortName" Value="Reprocess_Dates" />
                                <om:Property Name="MessageName" Value="Unblock" />
                                <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Unblock" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Receive" OID="75562784-cff7-43a0-8b90-5b4c9835de0f" ParentLink="ComplexStatement_Statement" LowerBound="344.1" HigherBound="346.1">
                                <om:Property Name="Activate" Value="False" />
                                <om:Property Name="PortName" Value="Reprocess_Dates" />
                                <om:Property Name="MessageName" Value="UnblockResponse" />
                                <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="OperationMessageName" Value="Response" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Unblock_Answer" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Terminate" OID="5f332373-dccd-4d81-8fe5-20e98f4483c4" ParentLink="ComplexStatement_Statement" LowerBound="346.1" HigherBound="348.1">
                            <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;Date Breach: Terminate export for {0}.  Case will be reprocessed if still Allocated.&quot;,helpdeskref);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Terminate_Due_To_Dates" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="DecisionBranch" OID="5cfd7359-47ec-4f49-bf2c-b8baf1e0a13d" ParentLink="ReallyComplexStatement_Branch">
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Else" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="294d0d5b-02a0-4bd2-b1e9-6070e9a11fd1" ParentLink="ServiceBody_Statement" LowerBound="349.1" HigherBound="352.1">
                    <om:Property Name="Expression" Value="stdXmlCommText = System.String.Format(&quot;Case {0} export commenced. Validating location and service with Maximo.&quot;,helpdeskref);&#xD;&#xA;stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;INFO&quot;,helpdeskref,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,stdXmlCommText,&quot;VisionFM&quot;);" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="CommExportCommenced" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Exec" OID="1d6e17bc-b444-4b12-9147-2e966404e486" ParentLink="ServiceBody_Statement" LowerBound="352.1" HigherBound="354.1">
                    <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="Create the VisionFM comm and OPs Support alert" />
                    <om:Property Name="Name" Value="StartOrchestration_5" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Parameter" OID="231b6d6e-fdba-4aaf-9da8-7c112ba30cc9" ParentLink="InvokeStatement_Parameter">
                        <om:Property Name="Direction" Value="In" />
                        <om:Property Name="Name" Value="stdXmlCommText" />
                        <om:Property Name="Type" Value="System.String" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="Call" OID="a680caac-8015-4ce8-9494-4c389f63bbec" ParentLink="ServiceBody_Statement" LowerBound="354.1" HigherBound="356.1">
                    <om:Property Name="Identifier" Value="CallOrchestration_1" />
                    <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.CheckMiamiCommodity" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="CallOrchestration_1" />
                    <om:Property Name="Signal" Value="False" />
                    <om:Element Type="Parameter" OID="ac2ef394-cdec-49c0-b917-65be84fc9e40" ParentLink="InvokeStatement_Parameter">
                        <om:Property Name="Direction" Value="In" />
                        <om:Property Name="Name" Value="TFM_MXO75_WO" />
                        <om:Property Name="Type" Value="MFM.Lbg.Schemas.DistibutedWorkItems" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Parameter" OID="a3653e88-62ee-4fb6-9611-21419713083e" ParentLink="InvokeStatement_Parameter">
                        <om:Property Name="Direction" Value="Out" />
                        <om:Property Name="Name" Value="CommodityValid" />
                        <om:Property Name="Type" Value="System.Boolean" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="Decision" OID="b857e260-09cf-4537-8fae-e1953f43bb08" ParentLink="ServiceBody_Statement" LowerBound="356.1" HigherBound="400.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Valid Commodity?" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DecisionBranch" OID="332a5dce-a1ef-459b-9e77-074dbeefb797" ParentLink="ReallyComplexStatement_Branch" LowerBound="357.13" HigherBound="400.1">
                        <om:Property Name="Expression" Value="CommodityValid == false" />
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="No" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="VariableAssignment" OID="e55d9d4f-2ce3-4284-b5b0-404f0c7c8c4d" ParentLink="ComplexStatement_Statement" LowerBound="359.1" HigherBound="364.1">
                            <om:Property Name="Expression" Value="errMsg = &quot;The service selected for this case is being rejected by Maximo.  This means the commodity code defined by&quot;;&#xD;&#xA;errMsg = errMsg + &quot; the bundle item is not expected.  The Maximo system has failed to validate and has rejected the case.&quot;;&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;The case will not be resent.&quot;;&#xD;&#xA;stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,System.String.Format(&quot;Customer: {1}, Error: The commodity code {0} is invalid&quot;,CommodityCode,Contract),&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,errMsg,&quot;VisionFM&quot;);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CommBadCommodity" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Parallel" OID="5fb0f47c-3e76-44cf-8046-e782764afeb4" ParentLink="ComplexStatement_Statement" LowerBound="364.1" HigherBound="389.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ParallelActions_1" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="ParallelBranch" OID="ab907abf-1642-45fc-bb3c-99ec0d8dc520" ParentLink="ReallyComplexStatement_Branch" LowerBound="369.1" HigherBound="382.1">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ParallelBranch_5" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="6cf0b761-e19b-4191-b2eb-d4a727aaf8e2" ParentLink="ComplexStatement_Statement" LowerBound="369.1" HigherBound="380.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructErrorEmail_F3_247" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="7fea2a0b-3dc2-409c-a2a3-9cdc06c7af66" ParentLink="Construct_MessageRef" LowerBound="370.35" HigherBound="370.49">
                                        <om:Property Name="Ref" Value="NotifyEmailOut" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="135ab577-bc19-4b1b-98a6-8dc37f70c438" ParentLink="ComplexStatement_Statement" LowerBound="372.1" HigherBound="379.1">
                                        <om:Property Name="Expression" Value="NotifyEmailOut = NotifyEmailParent;&#xD;&#xA;NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format(&quot;Beacon - Case: {1} Customer: {0}, The commodity code {1} is invalid &quot;,Contract,helpdeskref,CommodityCode));&#xD;&#xA;NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']&quot;) = Helper2.XslPath(&quot;TEAM247&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']&quot;) = System.String.Format(&quot;Error - The commodity code {0} is invalid&quot;,CommodityCode);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']&quot;) = errMsg;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Assign_F3_247" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="565f7b0e-726d-4318-b767-8cbd45e5decd" ParentLink="ComplexStatement_Statement" LowerBound="380.1" HigherBound="382.1">
                                    <om:Property Name="PortName" Value="PublishNotifyEmailToMb" />
                                    <om:Property Name="MessageName" Value="NotifyEmailOut" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_F3_Error_247" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="ParallelBranch" OID="2986f2a4-086d-4c93-8025-ff6e58eb0bde" ParentLink="ReallyComplexStatement_Branch" LowerBound="385.1" HigherBound="387.1">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ParallelBranch_7" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Exec" OID="d5b983db-c6e9-4b7a-ad2c-98f0c1c73145" ParentLink="ComplexStatement_Statement" LowerBound="385.1" HigherBound="387.1">
                                    <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="AnalystComments" Value="Create the VisionFM comm and OPs Support alert" />
                                    <om:Property Name="Name" Value="F3 Comm" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Parameter" OID="2dffeb12-add0-46b9-9eb0-460b769a78d5" ParentLink="InvokeStatement_Parameter">
                                        <om:Property Name="Direction" Value="In" />
                                        <om:Property Name="Name" Value="stdXmlCommText" />
                                        <om:Property Name="Type" Value="System.String" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="14483e5e-9935-417a-abf6-bd10c7f6ccfc" ParentLink="ComplexStatement_Statement" LowerBound="389.1" HigherBound="391.1">
                            <om:Property Name="PortName" Value="Reprocess_Dates" />
                            <om:Property Name="MessageName" Value="Distributed" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Illegal" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="3b255f0a-729b-4f7f-a5c9-f3ab08dbca1d" ParentLink="ComplexStatement_Statement" LowerBound="391.1" HigherBound="393.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Reprocess_Dates" />
                            <om:Property Name="MessageName" Value="DistributedResponse" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Illegal response" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Send" OID="111dd720-8a03-4695-a88b-b04a7136d8ac" ParentLink="ComplexStatement_Statement" LowerBound="393.1" HigherBound="395.1">
                            <om:Property Name="PortName" Value="Reprocess_Dates" />
                            <om:Property Name="MessageName" Value="Unblock" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Unblock" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="1341e816-f68c-4243-8581-7686cabef5e2" ParentLink="ComplexStatement_Statement" LowerBound="395.1" HigherBound="397.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Reprocess_Dates" />
                            <om:Property Name="MessageName" Value="UnblockResponse" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Unblock_Answer" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Terminate" OID="4a01a564-bd0e-4917-abe0-7b185d067a26" ParentLink="ComplexStatement_Statement" LowerBound="397.1" HigherBound="399.1">
                            <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;Date Breach: Terminate export for {0}.  The MiAMI commodity validation web service rejected this commodity value {1}.  The VisionFM case bundle item does not have an appropriate service defined on it that MTFM agree to provide.&quot;,helpdeskref,CommodityCode);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Terminate_Due_To_Commodity" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="DecisionBranch" OID="cdeda92b-3090-40a1-8a43-3ca91e1b29f2" ParentLink="ReallyComplexStatement_Branch">
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Else" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="5d4959b6-2fb1-43a2-9d16-4a955e3f39cb" ParentLink="ServiceBody_Statement" LowerBound="400.1" HigherBound="402.1">
                    <om:Property Name="Expression" Value="RetryCount = RetryCount + 1;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Retry Incrementor" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="Scope" OID="cccc47ea-9127-41bd-a504-b08a2c87cc3f" ParentLink="ServiceBody_Statement" LowerBound="402.1" HigherBound="623.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="True" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="must re-queue if error on web service call to get siteid. captue soap, deliveryfailure,xml,webexception,general." />
                    <om:Property Name="Name" Value="Scope_Query_Ws" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableDeclaration" OID="1a1e69a0-3aa2-44cf-9a3c-5b7817ab783b" ParentLink="Scope_VariableDeclaration" LowerBound="406.1" HigherBound="407.1">
                        <om:Property Name="UseDefaultConstructor" Value="True" />
                        <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Biz_comm_Soap_xml" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableDeclaration" OID="dc3376c3-0707-435e-a73d-0371aadeeb7f" ParentLink="Scope_VariableDeclaration" LowerBound="407.1" HigherBound="408.1">
                        <om:Property Name="UseDefaultConstructor" Value="False" />
                        <om:Property Name="Type" Value="System.String" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="dummy2" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Send" OID="b78c5741-15c0-414c-bd2d-91029d3737c2" ParentLink="ComplexStatement_Statement" LowerBound="412.1" HigherBound="414.1">
                        <om:Property Name="PortName" Value="Port_Query_Location" />
                        <om:Property Name="MessageName" Value="GetSiteIdQuery" />
                        <om:Property Name="OperationName" Value="QueryMXVISIONLOCQUERY" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send_2" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Receive" OID="1c3a5273-e27e-4e2b-8317-75d5b7d2c06c" ParentLink="ComplexStatement_Statement" LowerBound="414.1" HigherBound="416.1">
                        <om:Property Name="Activate" Value="False" />
                        <om:Property Name="PortName" Value="Port_Query_Location" />
                        <om:Property Name="MessageName" Value="GetSiteIdQueryResponse" />
                        <om:Property Name="OperationName" Value="QueryMXVISIONLOCQUERY" />
                        <om:Property Name="OperationMessageName" Value="Response" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Receive_1" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Construct" OID="8f85e366-2703-45d8-a7cc-511ee0fb320a" ParentLink="ComplexStatement_Statement" LowerBound="416.1" HigherBound="423.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_2" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="d335250f-f4f6-4d2a-8ab5-542e390bfaf8" ParentLink="Construct_MessageRef" LowerBound="417.31" HigherBound="417.57">
                            <om:Property Name="Ref" Value="GetSiteIdQueryResponse_out" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="4f093115-28c3-4ec4-bd30-9467369ea96e" ParentLink="ComplexStatement_Statement" LowerBound="419.1" HigherBound="422.1">
                            <om:Property Name="Expression" Value="GetSiteIdQueryResponse_out = GetSiteIdQueryResponse;&#xD;&#xA;GetSiteIdQueryResponse_out(FILE.ReceivedFileName) = TFM_MXO75_WO(FILE.ReceivedFileName);" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_2" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="28199fa3-99c2-47d6-b4cc-c7fe9f87ac68" ParentLink="ComplexStatement_Statement" LowerBound="423.1" HigherBound="425.1">
                        <om:Property Name="Expression" Value="WebServiceAvailable = true;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="WS Consumed" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Construct" OID="81e65b4b-e2bb-40d5-b6fa-a7a98bb5ea4b" ParentLink="ComplexStatement_Statement" LowerBound="425.1" HigherBound="431.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Construct TFM MXO75 WO F" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="2e60d9e3-2e9d-4ebf-bae7-79c265e12701" ParentLink="Construct_MessageRef" LowerBound="426.31" HigherBound="426.45">
                            <om:Property Name="Ref" Value="TFM_MXO75_WO_F" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="bca121ac-b13d-4743-a74d-796dd68cabde" ParentLink="ComplexStatement_Statement" LowerBound="428.1" HigherBound="430.1">
                            <om:Property Name="ClassName" Value="MFM.Lbg.Orcs.x_to_WO_F" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="x_to_WO_F" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="addcb79f-ddec-409e-9ea5-e9fa244c6efc" ParentLink="Transform_InputMessagePartRef" LowerBound="429.78" HigherBound="429.90">
                                <om:Property Name="MessageRef" Value="TFM_MXO75_WO" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_5" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="16dfcc89-d2a8-4973-b075-8a9f5a6e6223" ParentLink="Transform_InputMessagePartRef" LowerBound="429.92" HigherBound="429.125">
                                <om:Property Name="MessageRef" Value="GetSiteIdQueryResponse" />
                                <om:Property Name="PartRef" Value="parameters" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_6" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="8614c075-c033-4dac-8009-89a2fa8f9a9e" ParentLink="Transform_OutputMessagePartRef" LowerBound="429.36" HigherBound="429.50">
                                <om:Property Name="MessageRef" Value="TFM_MXO75_WO_F" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_7" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="d9003cac-4ce5-4642-bb25-167de2959cd3" ParentLink="ComplexStatement_Statement" LowerBound="431.1" HigherBound="486.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Check Location Lookup Result" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="812b5b89-1e19-41d8-a0fd-93713e16f2a1" ParentLink="ReallyComplexStatement_Branch" LowerBound="432.21" HigherBound="486.1">
                            <om:Property Name="Expression" Value="TFM_MXO75_WO_F.IssuedWork.Workitem.Location.Address.siteSiteName == &quot;&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="No Maximo SiteID" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Task" OID="ad08e94b-1e75-4777-b13f-0c832015f7ba" ParentLink="ComplexStatement_Statement" LowerBound="434.1" HigherBound="483.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Handle No Site ID" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="cf822ec0-2f17-4d2a-8a40-3bcf10aad078" ParentLink="ComplexStatement_Statement" LowerBound="434.1" HigherBound="448.1">
                                    <om:Property Name="Expression" Value="errMsg = &quot;The VisionFM location was not recognised by the MiAMI system.&quot;;&#xD;&#xA;errMsg = errMsg + System.String.Format(&quot;&lt;br /&gt;&lt;br /&gt;VisionFM stored MiAMI Building class 1 ({0}) at the location client property id.&quot;,mtfm2);&#xD;&#xA;&#xD;&#xA;if(DistributedWorkItem.IssuedWork.MRoute.ServiceLineType == &quot;AreaClass&quot;)&#xD;&#xA;{&#xD;&#xA;errMsg = errMsg + System.String.Format(&quot;&lt;br /&gt;VisionFM stores the MiAMI building class 2 value ({0}) against the company workpackagebundle {1}.&quot;,mtfm1,DistributedWorkItem.IssuedWork.Workitem.WorkPackageBundle.WorkPackageBundleName);&#xD;&#xA;}&#xD;&#xA;else&#xD;&#xA;{&#xD;&#xA;errMsg = errMsg + System.String.Format(&quot;&lt;br /&gt;VisionFM stores the MiAMI building class 2 value ({0}) against the location extra client unit code.&quot;,mtfm1);&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;The case will NOT be resent, it's location data is not compliant with MiAMI.  Contact the provider directly to progress this case. &quot;;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Build Err" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="01461b56-9bc5-4403-997d-75ea701cd78e" ParentLink="ComplexStatement_Statement" LowerBound="448.1" HigherBound="450.1">
                                    <om:Property Name="Expression" Value="stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,System.String.Format(&quot;Customer: {0}, Error: MiAMI rejected the location.&quot;,Contract),&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,errMsg,&quot;VisionFM&quot;);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CommBadSite" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Parallel" OID="ed03cbe5-0d8b-43a8-8cc4-7a3d579a69c2" ParentLink="ComplexStatement_Statement" LowerBound="450.1" HigherBound="475.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Parallel_Alerts_Bad_Location" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="ParallelBranch" OID="dad99bd5-818e-46cf-9fac-7a998abdf524" ParentLink="ReallyComplexStatement_Branch" LowerBound="455.1" HigherBound="468.1">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ParallelBranch_3" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="d16b1338-6723-47f3-a12f-f23a66e7429a" ParentLink="ComplexStatement_Statement" LowerBound="455.1" HigherBound="466.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ConstructErrorEmail_F4_247" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="d27d5fcd-910b-4eef-9ec2-2a146782029a" ParentLink="ComplexStatement_Statement" LowerBound="458.1" HigherBound="465.1">
                                                <om:Property Name="Expression" Value="NotifyEmailOut = NotifyEmailParent;&#xD;&#xA;NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format(&quot;Beacon - Case: {1} Customer: {0}, MiAMI rejected the location &quot;,Contract,helpdeskref));&#xD;&#xA;NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']&quot;) = Helper2.XslPath(&quot;TEAM247&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']&quot;) = System.String.Format(&quot;Error - MiAMI rejected the location&quot;,&quot;&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']&quot;) = errMsg;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Assign_F4_247" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="bc7bc158-5157-447e-aa1a-5e620ef84332" ParentLink="Construct_MessageRef" LowerBound="456.43" HigherBound="456.57">
                                                <om:Property Name="Ref" Value="NotifyEmailOut" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="15002005-37cf-40da-add5-5af83dd170c2" ParentLink="ComplexStatement_Statement" LowerBound="466.1" HigherBound="468.1">
                                            <om:Property Name="PortName" Value="PublishNotifyEmailToMb" />
                                            <om:Property Name="MessageName" Value="NotifyEmailOut" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_F4_Error_247" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="ParallelBranch" OID="5ea81e56-f71b-4b52-8701-f33eeec0237f" ParentLink="ReallyComplexStatement_Branch" LowerBound="471.1" HigherBound="473.1">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ParallelBranch_10" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Exec" OID="3bfd3366-59d3-4ac2-9223-bbe5fcd77de2" ParentLink="ComplexStatement_Statement" LowerBound="471.1" HigherBound="473.1">
                                            <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="AnalystComments" Value="Create VisioNFM Communication and Ops Support Email Alert" />
                                            <om:Property Name="Name" Value="F4 Comm" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Parameter" OID="2942086a-b2de-4260-83fb-704ba3a470ac" ParentLink="InvokeStatement_Parameter">
                                                <om:Property Name="Direction" Value="In" />
                                                <om:Property Name="Name" Value="stdXmlCommText" />
                                                <om:Property Name="Type" Value="System.String" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="49bbe1fb-d683-4f3c-aeac-9195cc9fda26" ParentLink="ComplexStatement_Statement" LowerBound="475.1" HigherBound="477.1">
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="Unblock" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Unblock" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="07c2d333-4c12-4886-b0b0-3dc1a206dc97" ParentLink="ComplexStatement_Statement" LowerBound="477.1" HigherBound="479.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="UnblockResponse" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Unblock_Answer" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Send" OID="28ca889f-294b-44b5-9a38-81e58064e7be" ParentLink="ComplexStatement_Statement" LowerBound="479.1" HigherBound="481.1">
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="Distributed" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Distr" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="0247ba51-c17f-4f3a-b94f-a849177eaed8" ParentLink="ComplexStatement_Statement" LowerBound="481.1" HigherBound="483.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="DistributedResponse" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_DsitrResp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Terminate" OID="3eddd2a9-f7b5-421d-a66c-9ec5173a55e9" ParentLink="ComplexStatement_Statement" LowerBound="483.1" HigherBound="485.1">
                                <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;Blocked no MiAMI Site Id: Case {0}.  Case is illegal.&quot;,helpdeskref);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_No_Site" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="d99e0f15-3ea3-4026-8536-4354acd6311b" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="ee29cd0f-056c-4d60-be58-193322aaceeb" ParentLink="ComplexStatement_Statement" LowerBound="486.1" HigherBound="488.1">
                        <om:Property Name="Expression" Value="LocationStatus = xpath(GetSiteIdQueryResponse.parameters,&quot;string(/*[local-name()='QueryMXVISIONLOCQUERYResponse' and namespace-uri()='http://www.ibm.com/maximo']/*[local-name()='MXVISIONLOCQUERYSet' and namespace-uri()='http://www.ibm.com/maximo']/*[local-name()='LOCATIONS' and namespace-uri()='http://www.ibm.com/maximo']/*[local-name()='STATUS' and namespace-uri()='http://www.ibm.com/maximo'][1])&quot;);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Get_LocStatus" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Decision" OID="feabca19-a02b-47aa-9630-642a53ee9d79" ParentLink="ComplexStatement_Statement" LowerBound="488.1" HigherBound="533.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Check Location Status Result" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="fcf595ee-ca8b-44b7-817c-34efede738a7" ParentLink="ReallyComplexStatement_Branch" LowerBound="489.21" HigherBound="533.1">
                            <om:Property Name="Expression" Value="LocationStatus == &quot;DECOMMISSIONED&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="IS Decomm" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Task" OID="f8552a8d-0b59-4726-9c2b-ab7869ee6479" ParentLink="ComplexStatement_Statement" LowerBound="491.1" HigherBound="530.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Handle No Site ID" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="8254dad3-25ec-4adb-9c92-422cac0a7e8d" ParentLink="ComplexStatement_Statement" LowerBound="491.1" HigherBound="495.1">
                                    <om:Property Name="Expression" Value="errMsg = &quot;The VisionFM location was is reported as DECOMMISIONED by MiAMI system.&quot;;&#xD;&#xA;errMsg = errMsg + System.String.Format(&quot;&lt;br /&gt;&lt;br /&gt;VisionFM stored MiAMI Building class 1 ({0}) at the location client property id.&quot;,mtfm2);&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;Current status: &quot; + LocationStatus + &quot;&lt;br /&gt;The case will NOT be resent, it's location data is not compliant with MiAMI.  Contact the provider directly to progress this case. &quot;;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Build Err" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="bdc4eabc-749c-4086-a2bf-88a640f59fc5" ParentLink="ComplexStatement_Statement" LowerBound="495.1" HigherBound="497.1">
                                    <om:Property Name="Expression" Value="stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,System.String.Format(&quot;Customer: {0}, Error: MiAMI rejected the location as decommisioned.&quot;,Contract),&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,errMsg,&quot;VisionFM&quot;);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CommBadSite" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Parallel" OID="a250d565-2d28-4be7-9d85-52caf986c3aa" ParentLink="ComplexStatement_Statement" LowerBound="497.1" HigherBound="522.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Parallel_Alerts_Bad_Location" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="ParallelBranch" OID="ab884c13-46b7-4f77-8b47-5c7910583030" ParentLink="ReallyComplexStatement_Branch" LowerBound="502.1" HigherBound="515.1">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ParallelBranch_3" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="5169b3e9-c8fa-4363-8716-920d4060474a" ParentLink="ComplexStatement_Statement" LowerBound="502.1" HigherBound="513.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ConstructErrorEmail_F4_2_247" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="6e51de8b-4e15-473e-afee-36183aa3ca7f" ParentLink="ComplexStatement_Statement" LowerBound="505.1" HigherBound="512.1">
                                                <om:Property Name="Expression" Value="NotifyEmailOut = NotifyEmailParent;&#xD;&#xA;NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format(&quot;Beacon - Case: {1} Customer: {0}, MiAMI rejected the location as decommissioned&quot;,Contract,helpdeskref));&#xD;&#xA;NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']&quot;) = Helper2.XslPath(&quot;TEAM247&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']&quot;) = System.String.Format(&quot;Error - MiAMI rejected the location&quot;,&quot;&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']&quot;) = errMsg;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Assign_F4_2_247" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="462841f4-f6c4-4f78-beb2-c15f13901bde" ParentLink="Construct_MessageRef" LowerBound="503.43" HigherBound="503.57">
                                                <om:Property Name="Ref" Value="NotifyEmailOut" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="72180240-d670-4afc-a880-e1a283b1f8a6" ParentLink="ComplexStatement_Statement" LowerBound="513.1" HigherBound="515.1">
                                            <om:Property Name="PortName" Value="PublishNotifyEmailToMb" />
                                            <om:Property Name="MessageName" Value="NotifyEmailOut" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_F4_2_Error_247" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="ParallelBranch" OID="4f701493-97b7-4e3a-b067-7611fec46668" ParentLink="ReallyComplexStatement_Branch" LowerBound="518.1" HigherBound="520.1">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ParallelBranch_10" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Exec" OID="ed8cc9a9-b475-433f-a88d-43f7e8758467" ParentLink="ComplexStatement_Statement" LowerBound="518.1" HigherBound="520.1">
                                            <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="AnalystComments" Value="Create VisioNFM Communication and Ops Support Email Alert" />
                                            <om:Property Name="Name" Value="F4_2 Comm" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Parameter" OID="71d3c433-3697-4cbf-bd6a-46ea77e7914c" ParentLink="InvokeStatement_Parameter">
                                                <om:Property Name="Direction" Value="In" />
                                                <om:Property Name="Name" Value="stdXmlCommText" />
                                                <om:Property Name="Type" Value="System.String" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="f8c2eb08-cd19-427f-bd1f-91f87cda6899" ParentLink="ComplexStatement_Statement" LowerBound="522.1" HigherBound="524.1">
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="Unblock" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Unblock" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="110f4fe1-3a4e-4eb3-90cd-a59cd0b31bf2" ParentLink="ComplexStatement_Statement" LowerBound="524.1" HigherBound="526.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="UnblockResponse" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Unblock_Answer" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Send" OID="c084ff5a-8726-480a-8f48-76a24e2e3edd" ParentLink="ComplexStatement_Statement" LowerBound="526.1" HigherBound="528.1">
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="Distributed" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Distr" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="8c49265b-5b40-44d8-9cd4-ad9c94e9d035" ParentLink="ComplexStatement_Statement" LowerBound="528.1" HigherBound="530.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="BlockNoSItePort" />
                                    <om:Property Name="MessageName" Value="DistributedResponse" />
                                    <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_DsitrResp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Terminate" OID="30e120e6-7513-4499-bc00-381bcc28a9d1" ParentLink="ComplexStatement_Statement" LowerBound="530.1" HigherBound="532.1">
                                <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;BlockedMiAMI Location is decommissioned Id: Case {0}.  Case is illegal.&quot;,helpdeskref);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_No_Site" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="07f7f26b-9bcf-425c-982d-ffcfb650026b" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="MessageDeclaration" OID="024f3ed7-45cd-46c9-991f-d8e005ec9657" ParentLink="Scope_MessageDeclaration" LowerBound="405.1" HigherBound="406.1">
                        <om:Property Name="Type" Value="MFM.Lbg.Schemas.BizTalk_Comm" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Biz_comm_ex_Ws" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Catch" OID="155fde93-44b9-41eb-a073-97035e2145c1" ParentLink="Scope_Catch" LowerBound="536.1" HigherBound="575.1">
                        <om:Property Name="ExceptionName" Value="SOAPFAULTEX" />
                        <om:Property Name="ExceptionType" Value="Port_Query_Location.QueryMXVISIONLOCQUERY.SoapBuildingFault" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="AnalystComments" Value="This is a data error - terminate the process and leave the case for manual handling." />
                        <om:Property Name="Name" Value="CatchSoapFault;Building" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="e85a9317-aeaa-4dda-9c62-78589bfb06de" ParentLink="Catch_Statement" LowerBound="539.1" HigherBound="545.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructBuildingFault" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="bc96ccc0-9f6e-4ce3-81e6-830142cadadb" ParentLink="ComplexStatement_Statement" LowerBound="542.1" HigherBound="544.1">
                                <om:Property Name="Expression" Value="Soap_Fault_BuildingCheck = SOAPFAULTEX;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="AssignFault" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="78ea5029-2ccd-4f92-8d06-381032abdec9" ParentLink="Construct_MessageRef" LowerBound="540.35" HigherBound="540.59">
                                <om:Property Name="Ref" Value="Soap_Fault_BuildingCheck" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Construct" OID="8a4c0ca8-c102-48bc-bc30-d600f13bbdb5" ParentLink="Catch_Statement" LowerBound="545.1" HigherBound="551.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_3" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Transform" OID="7a97f602-a791-46f1-93dd-6b335f6ceafd" ParentLink="ComplexStatement_Statement" LowerBound="548.1" HigherBound="550.1">
                                <om:Property Name="ClassName" Value="MFM.Lbg.Maps.m_Soap_1_1_To_MiamiSoap_1_1" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="x_to_friendlysoap" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessagePartRef" OID="f0e577d0-dcff-4a96-b6ad-791bece00b19" ParentLink="Transform_InputMessagePartRef" LowerBound="549.111" HigherBound="549.135">
                                    <om:Property Name="MessageRef" Value="Soap_Fault_BuildingCheck" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_10" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="8dd99188-86ac-46fd-9c02-25be6c39a312" ParentLink="Transform_OutputMessagePartRef" LowerBound="549.40" HigherBound="549.65">
                                    <om:Property Name="MessageRef" Value="MiamiSoapBuildingFriendly" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_11" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="MessageRef" OID="f2755bff-f4fe-41e6-aa8c-682577e0cad9" ParentLink="Construct_MessageRef" LowerBound="546.35" HigherBound="546.60">
                                <om:Property Name="Ref" Value="MiamiSoapBuildingFriendly" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="77977a5d-3b6a-436a-aef5-08acf9fa1252" ParentLink="Catch_Statement" LowerBound="551.1" HigherBound="553.1">
                            <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;MGP.Helpdesk.Distributor&quot;,MiamiSoapBuildingFriendly.faultString,System.Diagnostics.EventLogEntryType.Error);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Log Soap Building Error" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="39f49782-1971-42f8-b56c-1716fb26a667" ParentLink="Catch_Statement" LowerBound="553.1" HigherBound="556.1">
                            <om:Property Name="Expression" Value="stdXmlCommText = System.String.Format(&quot;MiAMI SOAP Error: {0}. \r\nMTFMBLDBCLASS ({1} {2}). \n\nNOT SENT.&quot;,MiamiSoapBuildingFriendly.faultString,mtfm1,mtfm2);&#xD;&#xA;stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,&quot;Maximo Web Service Returned a Fault.&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,stdXmlCommText,&quot;VisionFM&quot;);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CommSoapError" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Exec" OID="7df2f40e-ef30-4cc3-8114-c56c9cf2d484" ParentLink="Catch_Statement" LowerBound="556.1" HigherBound="558.1">
                            <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="StartOrchestration_2" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Parameter" OID="1981d74e-6abf-4495-85ae-8de56a6ea663" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="stdXmlCommText" />
                                <om:Property Name="Type" Value="System.String" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="0d41e339-dffe-416a-8e61-a3f08fe4c4a9" ParentLink="Catch_Statement" LowerBound="558.1" HigherBound="560.1">
                            <om:Property Name="PortName" Value="Unblock_3" />
                            <om:Property Name="MessageName" Value="Unblock" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_1" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="3ad3ebd4-0189-4b30-933d-a7bf5b76e67d" ParentLink="Catch_Statement" LowerBound="560.1" HigherBound="562.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Unblock_3" />
                            <om:Property Name="MessageName" Value="UnblockResponse" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_2" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="8d78afd7-40bc-43f2-8997-cc342f0b54b3" ParentLink="Catch_Statement" LowerBound="562.1" HigherBound="568.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_1" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="c73126c9-8673-4b7d-b059-fe2bd44aa316" ParentLink="ComplexStatement_Statement" LowerBound="565.1" HigherBound="567.1">
                                <om:Property Name="Expression" Value="TFM_MXO75_WO_F = TFM_MXO75_WO;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="ddc913fa-6242-4111-9a56-369ced9b59ad" ParentLink="Construct_MessageRef" LowerBound="563.35" HigherBound="563.49">
                                <om:Property Name="Ref" Value="TFM_MXO75_WO_F" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="eb4362d6-cf12-4951-b669-88578703e9de" ParentLink="Catch_Statement" LowerBound="568.1" HigherBound="570.1">
                            <om:Property Name="PortName" Value="Unblock_3" />
                            <om:Property Name="MessageName" Value="Distributed" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_3" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="de14d7bf-44a3-4033-b5b7-d18fb331dd9a" ParentLink="Catch_Statement" LowerBound="570.1" HigherBound="572.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Unblock_3" />
                            <om:Property Name="MessageName" Value="DistributedResponse" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_3" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Terminate" OID="030f88f8-b5e0-4076-9da4-bbadf5a73355" ParentLink="Catch_Statement" LowerBound="572.1" HigherBound="574.1">
                            <om:Property Name="ErrorMessage" Value="&quot;Investigate input file, SOAP fault message was returned from MiAMI building class check.&quot;;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Terminate" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="20500f55-6d58-49c5-b98e-8e2692235532" ParentLink="Scope_Catch" LowerBound="575.1" HigherBound="621.1">
                        <om:Property Name="ExceptionName" Value="Ex_Soap" />
                        <om:Property Name="ExceptionType" Value="System.Web.Services.Protocols.SoapException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="AnalystComments" Value="This is a Web Service availability issue - terminate and requeue message" />
                        <om:Property Name="Name" Value="CatchException_WS" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="17805ebb-a057-4342-9d54-4adcf8723847" ParentLink="Catch_Statement" LowerBound="578.1" HigherBound="580.1">
                            <om:Property Name="Expression" Value="xmlNack.LoadXml(Ex_Soap.Detail.InnerXml);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="getxmlNack" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="66ffe6fe-0859-470a-88a3-bcb2e6114c5a" ParentLink="Catch_Statement" LowerBound="580.1" HigherBound="586.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_Nack" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="de52c494-a78f-4d9a-9e97-fe40c68141a5" ParentLink="Construct_MessageRef" LowerBound="581.35" HigherBound="581.42">
                                <om:Property Name="Ref" Value="msgNack" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="22b5f224-526d-4855-b931-cf78d3a41d84" ParentLink="ComplexStatement_Statement" LowerBound="583.1" HigherBound="585.1">
                                <om:Property Name="Expression" Value="msgNack = xmlNack;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_4" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="c4e98283-1568-40cf-946c-ad3aaeb96657" ParentLink="Catch_Statement" LowerBound="586.1" HigherBound="599.1">
                            <om:Property Name="Expression" Value="ErrorDescription = xpath(msgNack,&quot;string(//ErrorDescription)&quot;);&#xD;&#xA;if (Helper2.IsOutOfHours() == true)&#xD;&#xA;{&#xD;&#xA;errMsg = &quot;MiAMI web service not available, the case will resend in 5 minutes time if it remains at Allocated.  If you move the case to accepted or attended it will not be retransmitted unless you re-allocate.&quot;;&#xD;&#xA;}&#xD;&#xA;else&#xD;&#xA;{&#xD;&#xA;errMsg = &quot;MiAMI web service not available, the case is suspended but will be resumed by an administrator. A notification has been sent to the Operational Support team to resolve, you do not need to take any further action.  Do not move the case to accepted or attended unless you have handled the case manually and have got the Maximo workorder number.&quot;;&#xD;&#xA;}&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;MessageType: &quot; + GetSiteIdQuery(BTS.MessageType);&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;Details: &lt;br /&gt;&lt;br /&gt;&quot; + ErrorDescription;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(eventLogSource, System.String.Format(&quot;An error occurred:  {0}&quot;, errMsg),System.Diagnostics.EventLogEntryType.Error);&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Build Err" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="2b6bc06b-64ab-4c84-ad0e-8efaf4b28db2" ParentLink="Catch_Statement" LowerBound="599.1" HigherBound="601.1">
                            <om:Property Name="Expression" Value="stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,&quot;Maximo Web Service Returned a Fault.&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,errMsg,&quot;VisionFM&quot;);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CommWsUnavailable" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Exec" OID="64ae4f01-503f-4292-9357-36fc9d9e9490" ParentLink="Catch_Statement" LowerBound="601.1" HigherBound="603.1">
                            <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="StartOrchestration_2" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Parameter" OID="e84d8c98-fa11-4bda-a62c-e97826f90329" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="stdXmlCommText" />
                                <om:Property Name="Type" Value="System.String" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="e0fe77d6-a2f9-44a3-9429-8bf7534ed951" ParentLink="Catch_Statement" LowerBound="603.1" HigherBound="614.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Suspend In Business Hours" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="b4b65d28-a465-43e9-88da-0d0829a4b3cc" ParentLink="ReallyComplexStatement_Branch" LowerBound="604.25" HigherBound="609.1">
                                <om:Property Name="Expression" Value="Helper2.IsOutOfHours() == false" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Yes" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Suspend" OID="716713a3-1964-42b2-a2ec-aa3221f0a17a" ParentLink="ComplexStatement_Statement" LowerBound="606.1" HigherBound="608.1">
                                    <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;The case has been suspended pending administrative action because the service {0} was unavailable.  If the web service is now available you can resume the message to reprocess it as long as the case stage is Allocated.  If the web service is not yet available you can still resume the message however it will suspend once it's retry behaviour has been exhausted. Do not terminate this instance unless you know the case no longer has to go to MiAMI.  Terminating the instance will leave a blocking record for this case id in table BizTalkExportControl.&quot;,GetSiteIdQuery(BTS.MessageType));" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Suspend_Me" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="ad90b770-98db-4f80-8506-e2bb4efec5ce" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Delay" OID="39ba7506-1a84-4c57-a857-0dbb9e3d9f13" ParentLink="ComplexStatement_Statement" LowerBound="611.1" HigherBound="613.1">
                                    <om:Property Name="Timeout" Value="new System.TimeSpan(0,0,0,300);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="AnalystComments" Value="The message will be requed to try again, but ony after 5 minutes.  The solution is self-repairing without suspended messages however if send port retry behaviour was exhausted, pause prioir to requeue." />
                                    <om:Property Name="Name" Value="Delay_OOH_Retry" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="b158b1a7-64de-4889-b82d-581dccd49b3c" ParentLink="Catch_Statement" LowerBound="614.1" HigherBound="616.1">
                            <om:Property Name="PortName" Value="Unblock_3" />
                            <om:Property Name="MessageName" Value="Unblock" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Requeue" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="682f5d1c-7843-4be0-a576-c3975adc6a9d" ParentLink="Catch_Statement" LowerBound="616.1" HigherBound="618.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Unblock_3" />
                            <om:Property Name="MessageName" Value="UnblockResponse" />
                            <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_2" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Terminate" OID="1fb32db9-a6a3-4202-ade2-29ee2d33f300" ParentLink="Catch_Statement" LowerBound="618.1" HigherBound="620.1">
                            <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;Web Query Failure, SOAP EXception:{0} case {1} is reqeued.&quot;,Ex_Soap.Message,DistributedWorkItem.IssuedWork.Workitem.HelpdeskReference);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Terminate_1" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
                <om:Element Type="Construct" OID="021f563a-65cd-46be-9445-57d343480b97" ParentLink="ServiceBody_Statement" LowerBound="623.1" HigherBound="632.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Construct TFM MXO75 WO F2" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="MessageRef" OID="15d8d52e-f7bc-4a15-8f77-12ca3d4fe47d" ParentLink="Construct_MessageRef" LowerBound="624.23" HigherBound="624.36">
                        <om:Property Name="Ref" Value="TFM_MXO75_F_2" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="MessageRef" OID="1295ea5d-013f-487d-8f9c-05d3afdc18b2" ParentLink="Construct_MessageRef" LowerBound="624.38" HigherBound="624.52">
                        <om:Property Name="Ref" Value="TFM_MXO75_F_22" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="MessageAssignment" OID="5a9d4865-75c4-4b49-a926-b17771b72f83" ParentLink="ComplexStatement_Statement" LowerBound="626.1" HigherBound="631.1">
                        <om:Property Name="Expression" Value="TFM_MXO75_F_2 = TFM_MXO75_WO_F;&#xD;&#xA;TFM_MXO75_F_2(FILE.ReceivedFileName) = TFM_MXO75_WO(FILE.ReceivedFileName);&#xD;&#xA;TFM_MXO75_F_22 = TFM_MXO75_WO_F;&#xD;&#xA;TFM_MXO75_F_22(FILE.ReceivedFileName) = TFM_MXO75_WO(FILE.ReceivedFileName);" />
                        <om:Property Name="ReportToAnalyst" Value="False" />
                        <om:Property Name="Name" Value="Assign_MFM_MXO75_WO" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="While" OID="2d436b1c-bcdd-4eeb-b177-71ebd6caf047" ParentLink="ServiceBody_Statement" LowerBound="632.1" HigherBound="680.1">
                    <om:Property Name="Expression" Value="Transmitted == false" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="Use loop to stop instance on fail to transmit, case will be blocked until resumed and successful." />
                    <om:Property Name="Name" Value="Loop_1" />
                    <om:Property Name="Signal" Value="False" />
                    <om:Element Type="Scope" OID="b2b6b767-2055-458d-b7b5-ac4b7ede263f" ParentLink="ComplexStatement_Statement" LowerBound="635.1" HigherBound="679.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_Deliver_To_TFM" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableDeclaration" OID="06979f8b-bdab-4b52-ac37-36d1bea87ba1" ParentLink="Scope_VariableDeclaration" LowerBound="638.1" HigherBound="639.1">
                            <om:Property Name="UseDefaultConstructor" Value="False" />
                            <om:Property Name="Type" Value="System.String" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="dummy3" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Send" OID="e3179324-8967-40dd-be94-e3b9fe3eab47" ParentLink="ComplexStatement_Statement" LowerBound="642.1" HigherBound="644.1">
                            <om:Property Name="PortName" Value="Port_TFM_MXO75_WO" />
                            <om:Property Name="MessageName" Value="TFM_MXO75_F_2" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="SendTFM_MXO75_WO" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="549f5356-3616-4cb5-aafd-bd1b9a6390f9" ParentLink="ComplexStatement_Statement" LowerBound="644.1" HigherBound="646.1">
                            <om:Property Name="Expression" Value="Transmitted = true;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Set_Transmitted" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Catch" OID="4ac8f931-04f3-4b5a-906f-48d83c9b852a" ParentLink="Scope_Catch" LowerBound="649.1" HigherBound="677.1">
                            <om:Property Name="ExceptionName" Value="Ex_Delivery" />
                            <om:Property Name="ExceptionType" Value="Microsoft.XLANGs.BaseTypes.DeliveryFailureException" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CatchException_Output" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="80cea7cf-e902-41d1-82af-4d135ded7cf5" ParentLink="Catch_Statement" LowerBound="652.1" HigherBound="654.1">
                                <om:Property Name="Expression" Value="Transmitted = false;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Set_Transmitted" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="11d65969-96d5-4fcb-8b93-58a5b52a65b0" ParentLink="Catch_Statement" LowerBound="654.1" HigherBound="656.1">
                                <om:Property Name="Expression" Value="WasBackup = true;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Set_WasBackup" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="8e18c74f-ad19-45b4-8b54-133436aecc1e" ParentLink="Catch_Statement" LowerBound="656.1" HigherBound="659.1">
                                <om:Property Name="Expression" Value="errMsg = System.String.Format(&quot;The case {0} could not be sent to the FTP server.&quot;,helpdeskref);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(eventLogSource,System.String.Format(&quot;An error occurred:  {0}&quot;, errMsg),System.Diagnostics.EventLogEntryType.Warning);&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Log" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Construct" OID="cce8726e-08ff-4d32-b295-0bbc41a97f72" ParentLink="Catch_Statement" LowerBound="659.1" HigherBound="670.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructErrorEmail_F4_247" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="cd483b42-4ae1-429b-a0a2-f125b872cfe0" ParentLink="Construct_MessageRef" LowerBound="660.39" HigherBound="660.53">
                                    <om:Property Name="Ref" Value="NotifyEmailOut" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="ec31bd3a-e06a-443b-92fb-6f871e56815b" ParentLink="ComplexStatement_Statement" LowerBound="662.1" HigherBound="669.1">
                                    <om:Property Name="Expression" Value="NotifyEmailOut = NotifyEmailParent;&#xD;&#xA;NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format(&quot;Beacon - Case: {1} Customer: {0}, MiAMI FTP unreachable &quot;,Contract,helpdeskref));&#xD;&#xA;NotifyEmailOut.EmailMetaData.To = &quot;Tony.Arrighi@mitie.com&quot;;&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']&quot;) = Helper2.XslPath(&quot;TEAM247&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']&quot;) = System.String.Format(&quot;Error - FTP unreachable, not sent&quot;,&quot;&quot;);&#xD;&#xA;xpath(NotifyEmailOut,&quot;/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']&quot;) = errMsg;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="Assign_F4_247" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="0b5bb85f-eb7c-4fe1-9ca4-2e2de0ff0442" ParentLink="Catch_Statement" LowerBound="670.1" HigherBound="672.1">
                                <om:Property Name="PortName" Value="PublishNotifyEmailToMb" />
                                <om:Property Name="MessageName" Value="NotifyEmailOut" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_F4_Error_247" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Send" OID="43fa942c-3ab5-479c-b516-fba2cf05ee5c" ParentLink="Catch_Statement" LowerBound="672.1" HigherBound="674.1">
                                <om:Property Name="PortName" Value="Failed_send_Port" />
                                <om:Property Name="MessageName" Value="TFM_MXO75_F_22" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_5" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Suspend" OID="f47db9d6-b85f-4cee-8de2-0b00b0404db7" ParentLink="Catch_Statement" LowerBound="674.1" HigherBound="676.1">
                                <om:Property Name="ErrorMessage" Value="System.String.Format(&quot;Resume to send to {0} FTP server&quot;,helpdeskref);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Suspend_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
                <om:Element Type="Task" OID="b1cb44e2-74eb-4f22-b352-9dc721622ab5" ParentLink="ServiceBody_Statement" LowerBound="680.1" HigherBound="719.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="Create a SENT message in VisionFM, this will create as a comm via a standard interface." />
                    <om:Property Name="Name" Value="Group_VisionFM_Comms" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableAssignment" OID="ed929e9b-0b86-4054-8340-cc7395c3f546" ParentLink="ComplexStatement_Statement" LowerBound="680.1" HigherBound="682.1">
                        <om:Property Name="Expression" Value="stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;SENT&quot;,helpdeskref,&quot;Case sent to provider system FTP.&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="SentFTP" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Exec" OID="22f0fb55-12a4-48c0-8a2d-9112876167df" ParentLink="ComplexStatement_Statement" LowerBound="682.1" HigherBound="684.1">
                        <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="StartOrchestration_3" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="Parameter" OID="8714de96-7c3e-4d85-b482-2be9eceab7dd" ParentLink="InvokeStatement_Parameter">
                            <om:Property Name="Direction" Value="In" />
                            <om:Property Name="Name" Value="stdXmlCommText" />
                            <om:Property Name="Type" Value="System.String" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Task" OID="255a65d2-c6a7-4fa9-a4bb-3ab4567301fe" ParentLink="ComplexStatement_Statement" LowerBound="684.1" HigherBound="686.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Archive it after comms sent" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Send" OID="4cd761a9-ed0b-41f1-9685-881c98c7dfdf" ParentLink="ComplexStatement_Statement" LowerBound="684.1" HigherBound="686.1">
                            <om:Property Name="PortName" Value="Archive_Sent_TFM_Wo" />
                            <om:Property Name="MessageName" Value="TFM_MXO75_F_22" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="AnalystComments" Value="Only archive after primary and secondary send to tfm have been invoked.  Much debate about writing the archive before dequeue, message has been delivered so appropriate to write archive.  Although sql locking is affecting to de-queue, the message will not come out again on a subsequent poll so this wtire is safe.  " />
                            <om:Property Name="Name" Value="Send_To_Disk_Archive" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Scope" OID="fee31ff8-16c8-4f38-9831-84d2f0c2fe1c" ParentLink="ComplexStatement_Statement" LowerBound="686.1" HigherBound="719.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_SQL_Error" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableDeclaration" OID="4822d1ad-f795-4716-91f3-e6a98002b38b" ParentLink="Scope_VariableDeclaration" LowerBound="690.1" HigherBound="691.1">
                            <om:Property Name="UseDefaultConstructor" Value="True" />
                            <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="SQL_Err_Xml" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableDeclaration" OID="ecbf3650-1f6b-4432-a96e-e79bd96dc6b5" ParentLink="Scope_VariableDeclaration" LowerBound="691.1" HigherBound="692.1">
                            <om:Property Name="UseDefaultConstructor" Value="False" />
                            <om:Property Name="Type" Value="System.String" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="dummy4" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Task" OID="9f2700de-dcf9-49e7-8e2a-eaae5f961982" ParentLink="ComplexStatement_Statement" LowerBound="696.1" HigherBound="700.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="AnalystComments" Value="This call to SQL is proving problematic with record locking - wrapping in scope is not really a problem, but supplier has the file written, so no real actions to take except guarentee that record will not duplicate on subsequent polling pass." />
                            <om:Property Name="Name" Value="Group_Mark_Complete" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Send" OID="8b2dd176-0404-426d-8553-b30693452df8" ParentLink="ComplexStatement_Statement" LowerBound="696.1" HigherBound="698.1">
                                <om:Property Name="PortName" Value="Port_Set_biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="MessageName" Value="Distributed" />
                                <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Remove_pending_Status" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Receive" OID="3df49ca7-3c07-4aa9-b4d0-76f755cc61df" ParentLink="ComplexStatement_Statement" LowerBound="698.1" HigherBound="700.1">
                                <om:Property Name="Activate" Value="False" />
                                <om:Property Name="PortName" Value="Port_Set_biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="MessageName" Value="DistributedResponse" />
                                <om:Property Name="OperationName" Value="biz_Global_Remove_Case_From_Queue" />
                                <om:Property Name="OperationMessageName" Value="Response" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Remove_pending_Status_response" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="bb019d5e-f544-4f68-9a6c-e1f87539fc10" ParentLink="Scope_MessageDeclaration" LowerBound="689.1" HigherBound="690.1">
                            <om:Property Name="Type" Value="MFM.Lbg.Schemas.BizTalk_Comm" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Biz_comm_ex_Sql" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Catch" OID="ff55269e-79e8-47cd-a955-1da5b5f60d96" ParentLink="Scope_Catch" LowerBound="703.1" HigherBound="717.1">
                            <om:Property Name="ExceptionName" Value="Ex_Dequeue" />
                            <om:Property Name="ExceptionType" Value="System.Web.Services.Protocols.SoapException" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Ex_SQL_Error" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="62d0dbee-7a5f-49fe-9147-56d241d4244a" ParentLink="Catch_Statement" LowerBound="706.1" HigherBound="712.1">
                                <om:Property Name="Expression" Value="errMsg = &quot;SQL error occurred. A System.Web.Services.Protocols.SoapException error occurred. &quot;;&#xD;&#xA;errMsg = errMsg + System.String.Format(&quot;The case {0} could not be fully marked as completed polling. Check and confirm with the vendor that the case is in their system.  If not requeue the job by removing its blocking record from the process queue.&quot;,helpdeskref);&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;MessageType: &quot; + GetSiteIdQuery(BTS.MessageType);&#xD;&#xA;errMsg = errMsg + &quot;&lt;br /&gt;&lt;br /&gt;Details: &lt;br /&gt;&lt;br /&gt;&quot; + Ex_Dequeue.Detail.InnerXml.ToString();&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(eventLogSource, System.String.Format(&quot;An error occurred:  {0}&quot;, errMsg),System.Diagnostics.EventLogEntryType.Error);&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Log_Catch_Ws" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="58821acc-b9cb-4dcd-a7b1-d042845c9785" ParentLink="Catch_Statement" LowerBound="712.1" HigherBound="714.1">
                                <om:Property Name="Expression" Value="stdXmlCommText = Helper2.getBizTalkComm(&quot;BIZTALK&quot;,&quot;ERROR&quot;,helpdeskref,&quot;Failed to fully mark case as processed.&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,Contract,errMsg,&quot;VisionFM&quot;);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CommMarkCOmpleteFailed" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Exec" OID="ebfcb5e7-9698-4da2-a70e-e43e3dd8be25" ParentLink="Catch_Statement" LowerBound="714.1" HigherBound="716.1">
                                <om:Property Name="Invokee" Value="MFM.Lbg.Orcs.o_LoadStandardComm" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="StartOrchestration_4" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Parameter" OID="345af9b3-276b-46fb-bf9b-1c56fe8796af" ParentLink="InvokeStatement_Parameter">
                                    <om:Property Name="Direction" Value="In" />
                                    <om:Property Name="Name" Value="stdXmlCommText" />
                                    <om:Property Name="Type" Value="System.String" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="1df4b345-feda-49e3-b547-2a2498ced047" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="85.1" HigherBound="87.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Port_get_TFM_MXO75_WO_Type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Get_TFM_MXO75_WO" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="18d8345a-d346-43fd-a187-576a4e357f5d" ParentLink="PortDeclaration_CLRAttribute" LowerBound="85.1" HigherBound="86.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0db57102-f267-4c25-b058-7da6fb51538f" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="87.1" HigherBound="89.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="175" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Port_Set_biz_Global_Remove_Case_From_Queue_Type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Unblock_3" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="c20377c7-da35-4282-bb63-a9a99a7250c0" ParentLink="PortDeclaration_CLRAttribute" LowerBound="87.1" HigherBound="88.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="2a178cfc-6bd1-43a3-951c-eb061b06ef11" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="89.1" HigherBound="92.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="246" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="Transmitted" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Port_Send_TFM_MXO75_WO_type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_TFM_MXO75_WO" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="513fced1-e0c7-4147-92bd-2576cafab3f9" ParentLink="PortDeclaration_CLRAttribute" LowerBound="89.1" HigherBound="90.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="cabe85a0-683d-4d53-b788-ca738a5cc196" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="92.1" HigherBound="94.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="263" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Archive_Sent_TFM_Wo_Type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive_Sent_TFM_Wo" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="4b9c41b6-9154-4f6b-b07d-844dd0e10b28" ParentLink="PortDeclaration_CLRAttribute" LowerBound="92.1" HigherBound="93.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="41d2182b-9d44-4c90-b234-845997526b74" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="94.1" HigherBound="96.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="305" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Port_Set_biz_Global_Remove_Case_From_Queue_Type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Set_biz_Global_Remove_Case_From_Queue" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="23b3df54-6915-4fef-a102-1724680e1825" ParentLink="PortDeclaration_CLRAttribute" LowerBound="94.1" HigherBound="95.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0f3e8ef5-a019-4f38-9247-59d7b9b685f9" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="96.1" HigherBound="98.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="172" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Port_biz_Global_Remove_Case_From_Queue_Type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="BlockNoSItePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="2fb95025-cba2-4fe0-bc6d-ffaa86d3a5ef" ParentLink="PortDeclaration_CLRAttribute" LowerBound="96.1" HigherBound="97.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="b9b5a078-5a75-44e0-b6b9-115db62f1962" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="98.1" HigherBound="101.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="164" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="Transmitted" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.MTFMVISIONFM_MTFMVISIONLOCQUERYPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Query_Location" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="02b90991-94e4-4076-a1ae-649ffb986384" ParentLink="PortDeclaration_CLRAttribute" LowerBound="98.1" HigherBound="99.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="8e063039-bb33-4ca8-8bda-c6b5dc53d5d3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="101.1" HigherBound="103.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="138" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Port_biz_Global_Remove_Case_From_Queue_Type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Reprocess_Dates" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="46f44c4f-1877-4f23-82b7-1cedae8e7534" ParentLink="PortDeclaration_CLRAttribute" LowerBound="101.1" HigherBound="102.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="db1fea84-4ed4-4a09-a57b-a0cd329937f8" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="103.1" HigherBound="105.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="117" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.PublishNotifyEmailToMbType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PublishNotifyEmailToMb" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="DirectBindingAttribute" OID="84b52963-b35c-40c9-9744-c3ed8c847e9f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="103.1" HigherBound="104.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="2d2d69c1-6b0f-473b-be72-01849a79954f" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="105.1" HigherBound="107.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="386" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="MFM.Lbg.Orcs.Failed_Send_Port_Type" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Failed_send_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="4ac1f046-53d5-4cd6-94fc-49efacbfa4d6" ParentLink="PortDeclaration_CLRAttribute" LowerBound="105.1" HigherBound="106.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="e6456d0d-999e-48f2-8cb7-bb77e4f1ba79" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:message name=&quot;QueryMXVISIONLOCQUERYResponse&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="QueryMXVISIONLOCQUERYResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="PartDeclaration" OID="7baea609-063b-4672-bf25-2f61c1eb423b" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="MFM.Lbg.Orcs.GenItems.MTFMVISIONFM_MTFMVISIONLOCQUERY_www_ibm_com_maximo.QueryMXVISIONLOCQUERYResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:part name=&quot;parameters&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="parameters" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="98667a9a-b518-4b73-a596-aabbdc05aaf8" ParentLink="Module_MessageType" LowerBound="8.1" HigherBound="12.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:message name=&quot;QueryMXVISIONLOCQUERYRequest&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="QueryMXVISIONLOCQUERYRequest" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="PartDeclaration" OID="06ebae39-b072-4636-976b-131c10b33fe1" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="10.1" HigherBound="11.1">
                <om:Property Name="ClassName" Value="MFM.Lbg.Orcs.GenItems.MTFMVISIONFM_MTFMVISIONLOCQUERY_www_ibm_com_maximo.QueryMXVISIONLOCQUERY" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:part name=&quot;parameters&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="parameters" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module MFM.Lbg.Orcs
{
    internal messagetype QueryMXVISIONLOCQUERYResponse
    {
        body GenItems.MTFMVISIONFM_MTFMVISIONLOCQUERY_www_ibm_com_maximo.QueryMXVISIONLOCQUERYResponse parameters;
    };
    internal messagetype QueryMXVISIONLOCQUERYRequest
    {
        body GenItems.MTFMVISIONFM_MTFMVISIONLOCQUERY_www_ibm_com_maximo.QueryMXVISIONLOCQUERY parameters;
    };
    internal porttype MTFMVISIONFM_MTFMVISIONLOCQUERYPortType
    {
        requestresponse QueryMXVISIONLOCQUERY
        {
            QueryMXVISIONLOCQUERYRequest, QueryMXVISIONLOCQUERYResponse, SoapBuildingFault = BTS.soap_envelope_1__1.Fault
        };
    };
    internal porttype Port_get_TFM_MXO75_WO_Type
    {
        oneway Operation_1
        {
            MFM.Lbg.Schemas.DistibutedWorkItems
        };
    };
    internal porttype Port_Send_TFM_MXO75_WO_type
    {
        oneway Operation_1
        {
            MFM.Lbg.Schemas.DistibutedWorkItems
        };
    };
    internal porttype TestPortType
    {
        oneway Operation_1
        {
            QueryMXVISIONLOCQUERYResponse
        };
    };
    internal porttype Standard_Biz_Comm_Type
    {
        oneway Operation_1
        {
            MFM.Lbg.Schemas.BizTalk_Comm
        };
    };
    internal porttype TFM_Backup_Port_Type
    {
        oneway Operation_1
        {
            MFM.Lbg.Schemas.DistibutedWorkItems
        };
    };
    internal porttype Archive_Sent_TFM_Wo_Type
    {
        oneway Operation_1
        {
            MFM.Lbg.Schemas.DistibutedWorkItems
        };
    };
    internal porttype Question_Port_Type
    {
        requestresponse biz_Get_Questions
        {
            MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_Questions, MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_QuestionsResponse
        };
    };
    internal porttype PublishNotifyEmailToMbType
    {
        oneway Operation_1
        {
            MSS.Notification.Service.MSSNotifyEmail
        };
    };
    internal porttype Failed_Send_Port_Type
    {
        oneway Operation_1
        {
            MFM.Lbg.Schemas.DistibutedWorkItems
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service o_Distribute_TFM_MXO75
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements Port_get_TFM_MXO75_WO_Type Port_Get_TFM_MXO75_WO;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses Port_Set_biz_Global_Remove_Case_From_Queue_Type Unblock_3;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        [Microsoft.XLANGs.BaseTypes.DeliveryNotification(Microsoft.XLANGs.BaseTypes.DeliveryNotification.NotificationLevel.Transmitted)]
        port uses Port_Send_TFM_MXO75_WO_type Port_TFM_MXO75_WO;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses Archive_Sent_TFM_Wo_Type Archive_Sent_TFM_Wo;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses Port_Set_biz_Global_Remove_Case_From_Queue_Type Port_Set_biz_Global_Remove_Case_From_Queue;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses Port_biz_Global_Remove_Case_From_Queue_Type BlockNoSItePort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        [Microsoft.XLANGs.BaseTypes.DeliveryNotification(Microsoft.XLANGs.BaseTypes.DeliveryNotification.NotificationLevel.Transmitted)]
        port uses MTFMVISIONFM_MTFMVISIONLOCQUERYPortType Port_Query_Location;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses Port_biz_Global_Remove_Case_From_Queue_Type Reprocess_Dates;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses PublishNotifyEmailToMbType PublishNotifyEmailToMb;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses Failed_Send_Port_Type Failed_send_Port;
        message MSS.Notification.Service.MSSNotifyEmail NotifyEmailOut;
        message BTS.soap_envelope_1__1.Fault Soap_Fault_BuildingCheck;
        message MFM.Lbg.Schemas.DistibutedWorkItems TFM_MXO75_F_22;
        message MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_QueueResponse UnblockResponse;
        message MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_Queue Unblock;
        message QueryMXVISIONLOCQUERYResponse GetSiteIdQueryResponse_out;
        message MFM.Lbg.Schemas.BizTalk_Comm Biz_comm_ex_Delivery;
        message MFM.Lbg.Schemas.DistibutedWorkItems TFM_MXO75_F_2;
        message MFM.Lbg.Schemas.DistibutedWorkItems TFM_MXO75_WO_F;
        message MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_QueueResponse DistributedResponse;
        message MFM.Lbg.Schemas.VFM_Extract_TypedProcedure_dbo.biz_Global_Remove_Case_From_Queue Distributed;
        message MFM.Lbg.Schemas.DistibutedWorkItems TFM_MXO75_WO;
        message MFM.Lbg.Schemas.DistibutedWorkItems DistributedWorkItem;
        message MFM.Lbg.Schemas.MTFMWOINService.MTFMWOIN TFM_MXO75_WO_R;
        message QueryMXVISIONLOCQUERYRequest GetSiteIdQuery;
        message QueryMXVISIONLOCQUERYResponse GetSiteIdQueryResponse;
        message MFM.Lbg.Schemas.BizTalk_Comm biz_comm;
        message MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_Questions GetQuestion;
        message MFM.Lbg.Schemas.biz_Get_Questions_TypedProcedure_dbo.biz_Get_QuestionsResponse GetQuestionResponse;
        message MFM.SharedResources.MSurvey SharedSurvey;
        message MFM.Lbg.Schemas.MiamiSoapError MiamiSoapBuildingFriendly;
        message System.Xml.XmlDocument msgNack;
        message MSS.Notification.Service.MSSNotifyEmail NotifyEmailParent;
        System.String LocationStatus;
        System.String tplSupport;
        System.String mtfm2;
        System.Xml.XmlDocument biz_comm_obj_xml;
        System.Boolean WasWebQError;
        System.Boolean WasBackup;
        System.String Target;
        System.String Filename;
        System.String biz_comm_str;
        System.Xml.XmlDocument biz_comm_obj;
        System.String helpdeskref;
        System.Boolean skip;
        System.String errMsg;
        System.String eventLogSource;
        System.String dummy1;
        System.String Contract;
        System.String mtfm1;
        System.Xml.XmlDocument xmlNack;
        System.String ErrorDescription;
        System.Boolean WebServiceAvailable;
        System.Int32 RetryCount;
        System.String stdXmlCommText;
        MFM.Lbg.Helper.Misc Helper2;
        System.Boolean CommodityValid;
        System.String CommodityCode;
        System.Int32 DatesExist;
        System.Boolean useTranslation;
        System.String SwitchXslt;
        System.String tpl247;
        System.String tplDist;
        System.String tplNotify;
        System.Boolean Transmitted;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("128613b0-c76c-4eb4-a270-22deb4ccb000")]
            activate ((MFM.Lbg.Schemas.VendorSystem == "TFMMXO75") && (MFM.Lbg.Schemas.Property1 != "VFX") && (MFM.Lbg.Schemas.ServiceLine1 != "VFX"))receive (Port_Get_TFM_MXO75_WO.Operation_1, DistributedWorkItem);
            LocationStatus = "";
            tplSupport = "";
            mtfm2 = "";
            biz_comm_obj_xml = new System.Xml.XmlDocument();
            WasWebQError = true;
            WasBackup = true;
            Target = "";
            Filename = "";
            biz_comm_str = "";
            biz_comm_obj = new System.Xml.XmlDocument();
            helpdeskref = "";
            skip = true;
            errMsg = "";
            eventLogSource = "";
            dummy1 = "";
            Contract = "";
            mtfm1 = "";
            xmlNack = new System.Xml.XmlDocument();
            ErrorDescription = "";
            WebServiceAvailable = true;
            stdXmlCommText = "";
            Helper2 = new MFM.Lbg.Helper.Misc();
            CommodityValid = true;
            CommodityCode = "";
            useTranslation = true;
            SwitchXslt = "";
            tpl247 = "";
            tplDist = "";
            tplNotify = "";
            Transmitted = true;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("68cb9920-5791-40d4-ac8f-0c3660656938")]
            Filename = System.Convert.ToString(DistributedWorkItem(FILE.ReceivedFileName));
            Target = System.String.Format("CAFM={0}",DistributedWorkItem(MFM.Lbg.Schemas.VendorSystem));
            Filename = Filename.Replace("Type=Extract",Target);
            skip = false;
            helpdeskref = DistributedWorkItem.IssuedWork.Workitem.HelpdeskReference;
            eventLogSource = "MFMHelpdeskDistributor";
            WasBackup = false;
            WebServiceAvailable = false;
            CommodityValid = false;
            CommodityCode = DistributedWorkItem.IssuedWork.Workitem.MService.VendorCode;
            tpl247 = "TEAM247";
            tplDist = "DIST";
            tplNotify = "TFM";
            tplSupport = "TEAMSUPP";
            useTranslation = true;
            Transmitted = false;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fc49c244-0b73-49a1-b679-15a13025dd63")]
            Contract = DistributedWorkItem.IssuedWork.MRoute.ContractName;
            mtfm1 = DistributedWorkItem.IssuedWork.Workitem.Location.linkpropertyid;
            mtfm2 = DistributedWorkItem.IssuedWork.Workitem.Location.Address.siteSiteID;
            RetryCount = 0;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c7a851a1-e4f1-44a0-9326-32357bcad25e")]
            construct NotifyEmailParent
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1261d58c-235f-4c0e-bbda-9700f9147667")]
                transform (NotifyEmailParent) = MFM.Lbg.Orcs.Base_Email_Notification (DistributedWorkItem);
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d462a77a-12e0-40cc-8095-7fee2ebeff07")]
            construct TFM_MXO75_WO
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("169e91be-b985-4e90-beb8-1f80fdd9cf0b")]
                TFM_MXO75_WO = DistributedWorkItem;
                TFM_MXO75_WO(FILE.ReceivedFileName) = Filename;
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8f87dd56-a2b0-4f84-8bf2-2987e73a1d98")]
            construct Distributed
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("eaf7f73b-b4dd-4d4b-bae5-9e63812dacf6")]
                transform (Distributed) = MFM.Lbg.Maps.DistributeMessage_To_RemoveFromQueue (DistributedWorkItem);
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("dd929784-a6ea-4745-b477-998ec38eda12")]
            construct Unblock
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c6d712a8-53de-44e2-b987-754f31e5b3e6")]
                transform (Unblock) = MFM.Lbg.Maps.DistributeMessage_To_ReQueue (DistributedWorkItem);
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ac8dda8f-6a21-4523-9952-97326bafbdc4")]
            construct GetSiteIdQuery
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4d166d27-9896-4466-9db1-86fd00a05923")]
                transform (GetSiteIdQuery.parameters) = MFM.Lbg.Orcs.x_to_Query (DistributedWorkItem);
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("00ea891e-02c9-4250-bdb1-0de6d2911a75")]
            scope synchronized
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("340a5410-1e24-4d16-96f8-4fe228e1748b")]
                    DatesExist = System.DateTime.Compare(DistributedWorkItem.IssuedWork.Workitem.VendorCompleteBy,DistributedWorkItem.IssuedWork.Workitem.VendorAttendBy);
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d9e96d41-0c60-4514-b1be-88440e5f1f58")]
                    catch (System.NullReferenceException eNullRef)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d931ab11-2f49-4c76-9cac-eb71cf6af006")]
                        errMsg = "The target start or complete time is missing.  This must be resolved before the case can be send to the provider system.";
                        errMsg = errMsg + "<br /><br />The case will be resent automatically in 10 minutes, the 'SLA Complete By' must be greater than the 'SLA Attend By' or this error will recur.  Both must exist.";
                        errMsg = errMsg + "<br />The case must remain at 'ALLOCATED' to be resent automatically";
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ddd681e4-5500-4e48-8770-19f5207a8159")]
                        stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,System.String.Format("Customer: {0}, SLA Start or Complete is missing",Contract),"","","",Contract,errMsg,"VisionFM");
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("71ad8746-6a34-442a-afee-1ca6c968658d")]
                        parallel
                        {
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5cf8ef89-d88e-46c4-a1b1-f5e579684491")]
                                construct NotifyEmailOut
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1d360215-d44e-41a0-ae34-3069f39b9e90")]
                                    NotifyEmailOut = NotifyEmailParent;
                                    NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format("Beacon - Case: {1} Customer: {0}, SLA Start or Complete is missing",Contract,helpdeskref));
                                    NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']") = Helper2.XslPath("TEAM247");
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']") = "SLA Start or Complete is missing";
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']") = errMsg;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a60828ea-f744-464e-8f31-b7b5dc94beb6")]
                                send (PublishNotifyEmailToMb.Operation_1, NotifyEmailOut);
                            }
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("65a05322-7c89-4aee-9a80-3753c5defc57")]
                                exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f9e4138e-1825-44cb-ae0a-0ce633325a91")]
                        delay new System.TimeSpan(0,0,10,0);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0e5b9b00-a26e-4ccc-9367-3ca3deb0025e")]
                        send (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, Unblock);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2c6334c6-bcde-420a-91d6-b585937bc365")]
                        receive (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, UnblockResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("15a04beb-eb99-4b6a-8598-1efce9d3fb80")]
                        terminate System.String.Format("Date Breach: Terminate export for {0}.  Case will be reprocessed if still Allocated.",helpdeskref);;
                    }
                }
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("55aa3365-97a2-4493-bedd-242b6c77cc86")]
            if (System.DateTime.Compare(DistributedWorkItem.IssuedWork.Workitem.VendorCompleteBy,DistributedWorkItem.IssuedWork.Workitem.VendorAttendBy) < 0)
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5353b618-249b-43e1-9ccd-510df9268d6a")]
                errMsg = "The target complete time is before the target attend time. This must be resolved before the case can be send to the provider system.";
                errMsg = errMsg + "<br /><br />Attend: " + System.Convert.ToString(DistributedWorkItem.IssuedWork.Workitem.VendorAttendBy);
                errMsg = errMsg + "<br />Complete: " + System.Convert.ToString(DistributedWorkItem.IssuedWork.Workitem.VendorCompleteBy);
                errMsg = errMsg + "<br /><br />The case will be resent automatically in 10 minutes, the 'SLA Complete By' must be greater than the 'SLA Attend By' or this error will recur.";
                errMsg = errMsg + "<br />The case must remain at 'ALLOCATED' to be resent automatically";
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b5f0c227-faab-4fc2-ad6a-0a61b4891d98")]
                stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,System.String.Format("Customer: {0}, Error: SLA Complete is before SLA Attend.",Contract),"","","",Contract,errMsg,"VisionFM");
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ee3b44f4-6f39-46c9-9c60-cc03a5eaabde")]
                parallel
                {
                    task
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d0003cd0-55e4-418f-99cf-e202fa78a7fa")]
                        construct NotifyEmailOut
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c2be4f77-9e89-4295-a5ae-c589e320a779")]
                            NotifyEmailOut = NotifyEmailParent;
                            NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format("Beacon - Case: {1} Customer: {0}, SLA Complete is before SLA Attend",Contract,helpdeskref));
                            NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();
                            xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']") = Helper2.XslPath("TEAM247");
                            xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']") = "Error - SLA Complete is before SLA Attend";
                            xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']") = errMsg;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ab16828a-40ab-4252-a559-b3ee266c7bd7")]
                        send (PublishNotifyEmailToMb.Operation_1, NotifyEmailOut);
                    }
                    task
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("26b573c7-268e-49c1-90ea-2eaed3d83bbb")]
                        exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d0c24c9f-a59e-4e55-9488-f6b7dc7cf134")]
                delay new System.TimeSpan(0,0,10,0);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7da0873b-5d37-4475-90ac-bc990f23cd78")]
                send (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, Unblock);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("75562784-cff7-43a0-8b90-5b4c9835de0f")]
                receive (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, UnblockResponse);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5f332373-dccd-4d81-8fe5-20e98f4483c4")]
                terminate System.String.Format("Date Breach: Terminate export for {0}.  Case will be reprocessed if still Allocated.",helpdeskref);;
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("294d0d5b-02a0-4bd2-b1e9-6070e9a11fd1")]
            stdXmlCommText = System.String.Format("Case {0} export commenced. Validating location and service with Maximo.",helpdeskref);
            stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","INFO",helpdeskref,"","","","",Contract,stdXmlCommText,"VisionFM");
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1d6e17bc-b444-4b12-9147-2e966404e486")]
            exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a680caac-8015-4ce8-9494-4c389f63bbec")]
            call MFM.Lbg.Orcs.CheckMiamiCommodity (TFM_MXO75_WO, out CommodityValid);
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b857e260-09cf-4537-8fae-e1953f43bb08")]
            if (CommodityValid == false)
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e55d9d4f-2ce3-4284-b5b0-404f0c7c8c4d")]
                errMsg = "The service selected for this case is being rejected by Maximo.  This means the commodity code defined by";
                errMsg = errMsg + " the bundle item is not expected.  The Maximo system has failed to validate and has rejected the case.";
                errMsg = errMsg + "<br /><br />The case will not be resent.";
                stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,System.String.Format("Customer: {1}, Error: The commodity code {0} is invalid",CommodityCode,Contract),"","","",Contract,errMsg,"VisionFM");
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5fb0f47c-3e76-44cf-8046-e782764afeb4")]
                parallel
                {
                    task
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6cf0b761-e19b-4191-b2eb-d4a727aaf8e2")]
                        construct NotifyEmailOut
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("135ab577-bc19-4b1b-98a6-8dc37f70c438")]
                            NotifyEmailOut = NotifyEmailParent;
                            NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format("Beacon - Case: {1} Customer: {0}, The commodity code {1} is invalid ",Contract,helpdeskref,CommodityCode));
                            NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();
                            xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']") = Helper2.XslPath("TEAM247");
                            xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']") = System.String.Format("Error - The commodity code {0} is invalid",CommodityCode);
                            xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']") = errMsg;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("565f7b0e-726d-4318-b767-8cbd45e5decd")]
                        send (PublishNotifyEmailToMb.Operation_1, NotifyEmailOut);
                    }
                    task
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d5b983db-c6e9-4b7a-ad2c-98f0c1c73145")]
                        exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("14483e5e-9935-417a-abf6-bd10c7f6ccfc")]
                send (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, Distributed);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3b255f0a-729b-4f7f-a5c9-f3ab08dbca1d")]
                receive (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, DistributedResponse);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("111dd720-8a03-4695-a88b-b04a7136d8ac")]
                send (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, Unblock);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1341e816-f68c-4243-8581-7686cabef5e2")]
                receive (Reprocess_Dates.biz_Global_Remove_Case_From_Queue, UnblockResponse);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4a01a564-bd0e-4917-abe0-7b185d067a26")]
                terminate System.String.Format("Date Breach: Terminate export for {0}.  The MiAMI commodity validation web service rejected this commodity value {1}.  The VisionFM case bundle item does not have an appropriate service defined on it that MTFM agree to provide.",helpdeskref,CommodityCode);;
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5d4959b6-2fb1-43a2-9d16-4a955e3f39cb")]
            RetryCount = RetryCount + 1;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cccc47ea-9127-41bd-a504-b08a2c87cc3f")]
            scope synchronized
            {
                message MFM.Lbg.Schemas.BizTalk_Comm Biz_comm_ex_Ws;
                System.Xml.XmlDocument Biz_comm_Soap_xml;
                System.String dummy2;
                body
                {
                    Biz_comm_Soap_xml = new System.Xml.XmlDocument();
                    dummy2 = "";
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b78c5741-15c0-414c-bd2d-91029d3737c2")]
                    send (Port_Query_Location.QueryMXVISIONLOCQUERY, GetSiteIdQuery);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1c3a5273-e27e-4e2b-8317-75d5b7d2c06c")]
                    receive (Port_Query_Location.QueryMXVISIONLOCQUERY, GetSiteIdQueryResponse);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8f85e366-2703-45d8-a7cc-511ee0fb320a")]
                    construct GetSiteIdQueryResponse_out
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4f093115-28c3-4ec4-bd30-9467369ea96e")]
                        GetSiteIdQueryResponse_out = GetSiteIdQueryResponse;
                        GetSiteIdQueryResponse_out(FILE.ReceivedFileName) = TFM_MXO75_WO(FILE.ReceivedFileName);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("28199fa3-99c2-47d6-b4cc-c7fe9f87ac68")]
                    WebServiceAvailable = true;
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("81e65b4b-e2bb-40d5-b6fa-a7a98bb5ea4b")]
                    construct TFM_MXO75_WO_F
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bca121ac-b13d-4743-a74d-796dd68cabde")]
                        transform (TFM_MXO75_WO_F) = MFM.Lbg.Orcs.x_to_WO_F (TFM_MXO75_WO, GetSiteIdQueryResponse.parameters);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d9003cac-4ce5-4642-bb25-167de2959cd3")]
                    if (TFM_MXO75_WO_F.IssuedWork.Workitem.Location.Address.siteSiteName == "")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cf822ec0-2f17-4d2a-8a40-3bcf10aad078")]
                        errMsg = "The VisionFM location was not recognised by the MiAMI system.";
                        errMsg = errMsg + System.String.Format("<br /><br />VisionFM stored MiAMI Building class 1 ({0}) at the location client property id.",mtfm2);
                        
                        if(DistributedWorkItem.IssuedWork.MRoute.ServiceLineType == "AreaClass")
                        {
                        errMsg = errMsg + System.String.Format("<br />VisionFM stores the MiAMI building class 2 value ({0}) against the company workpackagebundle {1}.",mtfm1,DistributedWorkItem.IssuedWork.Workitem.WorkPackageBundle.WorkPackageBundleName);
                        }
                        else
                        {
                        errMsg = errMsg + System.String.Format("<br />VisionFM stores the MiAMI building class 2 value ({0}) against the location extra client unit code.",mtfm1);
                        }
                        
                        errMsg = errMsg + "<br /><br />The case will NOT be resent, it's location data is not compliant with MiAMI.  Contact the provider directly to progress this case. ";
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("01461b56-9bc5-4403-997d-75ea701cd78e")]
                        stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,System.String.Format("Customer: {0}, Error: MiAMI rejected the location.",Contract),"","","",Contract,errMsg,"VisionFM");
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ed03cbe5-0d8b-43a8-8cc4-7a3d579a69c2")]
                        parallel
                        {
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d16b1338-6723-47f3-a12f-f23a66e7429a")]
                                construct NotifyEmailOut
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d27d5fcd-910b-4eef-9ec2-2a146782029a")]
                                    NotifyEmailOut = NotifyEmailParent;
                                    NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format("Beacon - Case: {1} Customer: {0}, MiAMI rejected the location ",Contract,helpdeskref));
                                    NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']") = Helper2.XslPath("TEAM247");
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']") = System.String.Format("Error - MiAMI rejected the location","");
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']") = errMsg;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("15002005-37cf-40da-add5-5af83dd170c2")]
                                send (PublishNotifyEmailToMb.Operation_1, NotifyEmailOut);
                            }
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3bfd3366-59d3-4ac2-9223-bbe5fcd77de2")]
                                exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("49bbe1fb-d683-4f3c-aeac-9195cc9fda26")]
                        send (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, Unblock);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("07c2d333-4c12-4886-b0b0-3dc1a206dc97")]
                        receive (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, UnblockResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("28ca889f-294b-44b5-9a38-81e58064e7be")]
                        send (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, Distributed);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0247ba51-c17f-4f3a-b94f-a849177eaed8")]
                        receive (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, DistributedResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3eddd2a9-f7b5-421d-a66c-9ec5173a55e9")]
                        terminate System.String.Format("Blocked no MiAMI Site Id: Case {0}.  Case is illegal.",helpdeskref);;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ee29cd0f-056c-4d60-be58-193322aaceeb")]
                    LocationStatus = xpath(GetSiteIdQueryResponse.parameters,"string(/*[local-name()='QueryMXVISIONLOCQUERYResponse' and namespace-uri()='http://www.ibm.com/maximo']/*[local-name()='MXVISIONLOCQUERYSet' and namespace-uri()='http://www.ibm.com/maximo']/*[local-name()='LOCATIONS' and namespace-uri()='http://www.ibm.com/maximo']/*[local-name()='STATUS' and namespace-uri()='http://www.ibm.com/maximo'][1])");
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("feabca19-a02b-47aa-9630-642a53ee9d79")]
                    if (LocationStatus == "DECOMMISSIONED")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8254dad3-25ec-4adb-9c92-422cac0a7e8d")]
                        errMsg = "The VisionFM location was is reported as DECOMMISIONED by MiAMI system.";
                        errMsg = errMsg + System.String.Format("<br /><br />VisionFM stored MiAMI Building class 1 ({0}) at the location client property id.",mtfm2);
                        errMsg = errMsg + "<br />Current status: " + LocationStatus + "<br />The case will NOT be resent, it's location data is not compliant with MiAMI.  Contact the provider directly to progress this case. ";
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bdc4eabc-749c-4086-a2bf-88a640f59fc5")]
                        stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,System.String.Format("Customer: {0}, Error: MiAMI rejected the location as decommisioned.",Contract),"","","",Contract,errMsg,"VisionFM");
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a250d565-2d28-4be7-9d85-52caf986c3aa")]
                        parallel
                        {
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5169b3e9-c8fa-4363-8716-920d4060474a")]
                                construct NotifyEmailOut
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e51de8b-4e15-473e-afee-36183aa3ca7f")]
                                    NotifyEmailOut = NotifyEmailParent;
                                    NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format("Beacon - Case: {1} Customer: {0}, MiAMI rejected the location as decommissioned",Contract,helpdeskref));
                                    NotifyEmailOut.EmailMetaData.To = Helper2.GetVisionFmTeamLeaderMailbox();
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']") = Helper2.XslPath("TEAM247");
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']") = System.String.Format("Error - MiAMI rejected the location","");
                                    xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']") = errMsg;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("72180240-d670-4afc-a880-e1a283b1f8a6")]
                                send (PublishNotifyEmailToMb.Operation_1, NotifyEmailOut);
                            }
                            task
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ed8cc9a9-b475-433f-a88d-43f7e8758467")]
                                exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f8c2eb08-cd19-427f-bd1f-91f87cda6899")]
                        send (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, Unblock);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("110f4fe1-3a4e-4eb3-90cd-a59cd0b31bf2")]
                        receive (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, UnblockResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c084ff5a-8726-480a-8f48-76a24e2e3edd")]
                        send (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, Distributed);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8c49265b-5b40-44d8-9cd4-ad9c94e9d035")]
                        receive (BlockNoSItePort.biz_Global_Remove_Case_From_Queue, DistributedResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("30e120e6-7513-4499-bc00-381bcc28a9d1")]
                        terminate System.String.Format("BlockedMiAMI Location is decommissioned Id: Case {0}.  Case is illegal.",helpdeskref);;
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("155fde93-44b9-41eb-a073-97035e2145c1")]
                    catch (Port_Query_Location.QueryMXVISIONLOCQUERY.SoapBuildingFault SOAPFAULTEX)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e85a9317-aeaa-4dda-9c62-78589bfb06de")]
                        construct Soap_Fault_BuildingCheck
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bc96ccc0-9f6e-4ce3-81e6-830142cadadb")]
                            Soap_Fault_BuildingCheck = SOAPFAULTEX;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8a4c0ca8-c102-48bc-bc30-d600f13bbdb5")]
                        construct MiamiSoapBuildingFriendly
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7a97f602-a791-46f1-93dd-6b335f6ceafd")]
                            transform (MiamiSoapBuildingFriendly) = MFM.Lbg.Maps.m_Soap_1_1_To_MiamiSoap_1_1 (Soap_Fault_BuildingCheck);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("77977a5d-3b6a-436a-aef5-08acf9fa1252")]
                        System.Diagnostics.EventLog.WriteEntry("MGP.Helpdesk.Distributor",MiamiSoapBuildingFriendly.faultString,System.Diagnostics.EventLogEntryType.Error);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("39f49782-1971-42f8-b56c-1716fb26a667")]
                        stdXmlCommText = System.String.Format("MiAMI SOAP Error: {0}. \r\nMTFMBLDBCLASS ({1} {2}). \n\nNOT SENT.",MiamiSoapBuildingFriendly.faultString,mtfm1,mtfm2);
                        stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,"Maximo Web Service Returned a Fault.","","","",Contract,stdXmlCommText,"VisionFM");
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7df2f40e-ef30-4cc3-8114-c56c9cf2d484")]
                        exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0d41e339-dffe-416a-8e61-a3f08fe4c4a9")]
                        send (Unblock_3.biz_Global_Remove_Case_From_Queue, Unblock);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3ad3ebd4-0189-4b30-933d-a7bf5b76e67d")]
                        receive (Unblock_3.biz_Global_Remove_Case_From_Queue, UnblockResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8d78afd7-40bc-43f2-8997-cc342f0b54b3")]
                        construct TFM_MXO75_WO_F
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c73126c9-8673-4b7d-b059-fe2bd44aa316")]
                            TFM_MXO75_WO_F = TFM_MXO75_WO;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("eb4362d6-cf12-4951-b669-88578703e9de")]
                        send (Unblock_3.biz_Global_Remove_Case_From_Queue, Distributed);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("de14d7bf-44a3-4033-b5b7-d18fb331dd9a")]
                        receive (Unblock_3.biz_Global_Remove_Case_From_Queue, DistributedResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("030f88f8-b5e0-4076-9da4-bbadf5a73355")]
                        terminate "Investigate input file, SOAP fault message was returned from MiAMI building class check.";;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("20500f55-6d58-49c5-b98e-8e2692235532")]
                    catch (System.Web.Services.Protocols.SoapException Ex_Soap)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("17805ebb-a057-4342-9d54-4adcf8723847")]
                        xmlNack.LoadXml(Ex_Soap.Detail.InnerXml);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("66ffe6fe-0859-470a-88a3-bcb2e6114c5a")]
                        construct msgNack
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("22b5f224-526d-4855-b931-cf78d3a41d84")]
                            msgNack = xmlNack;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c4e98283-1568-40cf-946c-ad3aaeb96657")]
                        ErrorDescription = xpath(msgNack,"string(//ErrorDescription)");
                        if (Helper2.IsOutOfHours() == true)
                        {
                        errMsg = "MiAMI web service not available, the case will resend in 5 minutes time if it remains at Allocated.  If you move the case to accepted or attended it will not be retransmitted unless you re-allocate.";
                        }
                        else
                        {
                        errMsg = "MiAMI web service not available, the case is suspended but will be resumed by an administrator. A notification has been sent to the Operational Support team to resolve, you do not need to take any further action.  Do not move the case to accepted or attended unless you have handled the case manually and have got the Maximo workorder number.";
                        }
                        errMsg = errMsg + "<br /><br />MessageType: " + GetSiteIdQuery(BTS.MessageType);
                        errMsg = errMsg + "<br /><br />Details: <br /><br />" + ErrorDescription;
                        System.Diagnostics.EventLog.WriteEntry(eventLogSource, System.String.Format("An error occurred:  {0}", errMsg),System.Diagnostics.EventLogEntryType.Error);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2b6bc06b-64ab-4c84-ad0e-8efaf4b28db2")]
                        stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,"Maximo Web Service Returned a Fault.","","","",Contract,errMsg,"VisionFM");
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("64ae4f01-503f-4292-9357-36fc9d9e9490")]
                        exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e0fe77d6-a2f9-44a3-9429-8bf7534ed951")]
                        if (Helper2.IsOutOfHours() == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("716713a3-1964-42b2-a2ec-aa3221f0a17a")]
                            suspend System.String.Format("The case has been suspended pending administrative action because the service {0} was unavailable.  If the web service is now available you can resume the message to reprocess it as long as the case stage is Allocated.  If the web service is not yet available you can still resume the message however it will suspend once it's retry behaviour has been exhausted. Do not terminate this instance unless you know the case no longer has to go to MiAMI.  Terminating the instance will leave a blocking record for this case id in table BizTalkExportControl.",GetSiteIdQuery(BTS.MessageType));
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("39ba7506-1a84-4c57-a857-0dbb9e3d9f13")]
                            delay new System.TimeSpan(0,0,0,300);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b158b1a7-64de-4889-b82d-581dccd49b3c")]
                        send (Unblock_3.biz_Global_Remove_Case_From_Queue, Unblock);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("682f5d1c-7843-4be0-a576-c3975adc6a9d")]
                        receive (Unblock_3.biz_Global_Remove_Case_From_Queue, UnblockResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1fb32db9-a6a3-4202-ade2-29ee2d33f300")]
                        terminate System.String.Format("Web Query Failure, SOAP EXception:{0} case {1} is reqeued.",Ex_Soap.Message,DistributedWorkItem.IssuedWork.Workitem.HelpdeskReference);;
                    }
                }
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("021f563a-65cd-46be-9445-57d343480b97")]
            construct TFM_MXO75_F_2, TFM_MXO75_F_22
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5a9d4865-75c4-4b49-a926-b17771b72f83")]
                TFM_MXO75_F_2 = TFM_MXO75_WO_F;
                TFM_MXO75_F_2(FILE.ReceivedFileName) = TFM_MXO75_WO(FILE.ReceivedFileName);
                TFM_MXO75_F_22 = TFM_MXO75_WO_F;
                TFM_MXO75_F_22(FILE.ReceivedFileName) = TFM_MXO75_WO(FILE.ReceivedFileName);
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2d436b1c-bcdd-4eeb-b177-71ebd6caf047")]
            while (Transmitted == false)
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b2b6b767-2055-458d-b7b5-ac4b7ede263f")]
                scope synchronized
                {
                    System.String dummy3;
                    body
                    {
                        dummy3 = "";
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e3179324-8967-40dd-be94-e3b9fe3eab47")]
                        send (Port_TFM_MXO75_WO.Operation_1, TFM_MXO75_F_2);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("549f5356-3616-4cb5-aafd-bd1b9a6390f9")]
                        Transmitted = true;
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4ac8f931-04f3-4b5a-906f-48d83c9b852a")]
                        catch (Microsoft.XLANGs.BaseTypes.DeliveryFailureException Ex_Delivery)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("80cea7cf-e902-41d1-82af-4d135ded7cf5")]
                            Transmitted = false;
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("11d65969-96d5-4fcb-8b93-58a5b52a65b0")]
                            WasBackup = true;
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8e18c74f-ad19-45b4-8b54-133436aecc1e")]
                            errMsg = System.String.Format("The case {0} could not be sent to the FTP server.",helpdeskref);
                            System.Diagnostics.EventLog.WriteEntry(eventLogSource,System.String.Format("An error occurred:  {0}", errMsg),System.Diagnostics.EventLogEntryType.Warning);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cce8726e-08ff-4d32-b295-0bbc41a97f72")]
                            construct NotifyEmailOut
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ec31bd3a-e06a-443b-92fb-6f871e56815b")]
                                NotifyEmailOut = NotifyEmailParent;
                                NotifyEmailOut.EmailMetaData.Subject =  Helper2.AddEnvironmentToSubjet(System.String.Format("Beacon - Case: {1} Customer: {0}, MiAMI FTP unreachable ",Contract,helpdeskref));
                                NotifyEmailOut.EmailMetaData.To = "Tony.Arrighi@mitie.com";
                                xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='PathToTransform' and namespace-uri()='']") = Helper2.XslPath("TEAM247");
                                xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P2' and namespace-uri()='']") = System.String.Format("Error - FTP unreachable, not sent","");
                                xpath(NotifyEmailOut,"/*[local-name()='MSSNotifyEmail' and namespace-uri()='http://MSS.Notification.Service.NotifyEmail/v1']/*[local-name()='EmailContentData' and namespace-uri()='']/*[local-name()='BodyNonRecurring' and namespace-uri()='']/*[local-name()='P4' and namespace-uri()='']") = errMsg;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0b5bb85f-eb7c-4fe1-9ca4-2e2de0ff0442")]
                            send (PublishNotifyEmailToMb.Operation_1, NotifyEmailOut);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("43fa942c-3ab5-479c-b516-fba2cf05ee5c")]
                            send (Failed_send_Port.Operation_1, TFM_MXO75_F_22);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f47db9d6-b85f-4cee-8de2-0b00b0404db7")]
                            suspend System.String.Format("Resume to send to {0} FTP server",helpdeskref);
                        }
                    }
                }
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ed929e9b-0b86-4054-8340-cc7395c3f546")]
            stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","SENT",helpdeskref,"Case sent to provider system FTP.","","","","","","");
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("22f0fb55-12a4-48c0-8a2d-9112876167df")]
            exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4cd761a9-ed0b-41f1-9685-881c98c7dfdf")]
            send (Archive_Sent_TFM_Wo.Operation_1, TFM_MXO75_F_22);
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fee31ff8-16c8-4f38-9831-84d2f0c2fe1c")]
            scope
            {
                message MFM.Lbg.Schemas.BizTalk_Comm Biz_comm_ex_Sql;
                System.Xml.XmlDocument SQL_Err_Xml;
                System.String dummy4;
                body
                {
                    SQL_Err_Xml = new System.Xml.XmlDocument();
                    dummy4 = "";
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8b2dd176-0404-426d-8553-b30693452df8")]
                    send (Port_Set_biz_Global_Remove_Case_From_Queue.biz_Global_Remove_Case_From_Queue, Distributed);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3df49ca7-3c07-4aa9-b4d0-76f755cc61df")]
                    receive (Port_Set_biz_Global_Remove_Case_From_Queue.biz_Global_Remove_Case_From_Queue, DistributedResponse);
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ff55269e-79e8-47cd-a955-1da5b5f60d96")]
                    catch (System.Web.Services.Protocols.SoapException Ex_Dequeue)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("62d0dbee-7a5f-49fe-9147-56d241d4244a")]
                        errMsg = "SQL error occurred. A System.Web.Services.Protocols.SoapException error occurred. ";
                        errMsg = errMsg + System.String.Format("The case {0} could not be fully marked as completed polling. Check and confirm with the vendor that the case is in their system.  If not requeue the job by removing its blocking record from the process queue.",helpdeskref);
                        errMsg = errMsg + "<br />MessageType: " + GetSiteIdQuery(BTS.MessageType);
                        errMsg = errMsg + "<br /><br />Details: <br /><br />" + Ex_Dequeue.Detail.InnerXml.ToString();
                        System.Diagnostics.EventLog.WriteEntry(eventLogSource, System.String.Format("An error occurred:  {0}", errMsg),System.Diagnostics.EventLogEntryType.Error);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("58821acc-b9cb-4dcd-a7b1-d042845c9785")]
                        stdXmlCommText = Helper2.getBizTalkComm("BIZTALK","ERROR",helpdeskref,"Failed to fully mark case as processed.","","","",Contract,errMsg,"VisionFM");
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ebfcb5e7-9698-4da2-a70e-e43e3dd8be25")]
                        exec MFM.Lbg.Orcs.o_LoadStandardComm (stdXmlCommText);
                    }
                }
            }
        }
    }
}

